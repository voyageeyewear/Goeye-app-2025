<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Eyejack Admin Dashboard</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .dashboard-container {
            max-width: 1400px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            overflow: hidden;
        }

        .dashboard-header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }

        .dashboard-header h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 15px;
        }

        .dashboard-header p {
            font-size: 1.1rem;
            opacity: 0.9;
        }

        .connection-status {
            display: inline-flex;
            align-items: center;
            gap: 8px;
            background: rgba(255,255,255,0.2);
            padding: 8px 16px;
            border-radius: 20px;
            margin-top: 15px;
        }

        .test-connection-btn {
            background: rgba(255,255,255,0.2);
            color: white;
            border: 1px solid rgba(255,255,255,0.3);
            padding: 8px 16px;
            border-radius: 20px;
            cursor: pointer;
            margin-left: 10px;
            transition: all 0.3s ease;
        }

        .save-all-btn {
            background: linear-gradient(135deg, #10b981, #059669);
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 20px;
            cursor: pointer;
            margin-left: 10px;
            font-weight: bold;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(16, 185, 129, 0.3);
        }

        .save-all-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(16, 185, 129, 0.4);
        }

        .save-all-btn:active {
            transform: translateY(0);
        }

        .test-connection-btn:hover {
            background: rgba(255,255,255,0.3);
        }

        .status-dot {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background: #4ade80;
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }

        .tabs-container {
            padding: 0;
        }

        .tabs-header {
            display: flex;
            background: #f8fafc;
            border-bottom: 2px solid #e2e8f0;
            overflow-x: auto;
        }

        .tab-button {
            padding: 15px 25px;
            background: none;
            border: none;
            cursor: pointer;
            font-size: 14px;
            font-weight: 600;
            color: #64748b;
            transition: all 0.3s ease;
            white-space: nowrap;
            border-bottom: 3px solid transparent;
        }

        .tab-button:hover {
            background: #e2e8f0;
            color: #475569;
        }

        .tab-button.active {
            color: #3b82f6;
            background: white;
            border-bottom-color: #3b82f6;
        }

        .tab-content {
            display: none;
            padding: 30px;
            min-height: 500px;
        }

        .tab-content.active {
            display: block;
        }

        .section-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .customization-card {
            background: white;
            border: 2px solid #e2e8f0;
            border-radius: 12px;
            padding: 20px;
            transition: all 0.3s ease;
        }

        .customization-card:hover {
            border-color: #3b82f6;
            box-shadow: 0 8px 25px rgba(59, 130, 246, 0.15);
        }

        .card-header {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 15px;
        }

        .card-icon {
            font-size: 1.5rem;
        }

        .card-title {
            font-size: 1.1rem;
            font-weight: 600;
            color: #1e293b;
        }

        .form-group {
            margin-bottom: 15px;
        }

        .form-label {
            display: block;
            font-weight: 500;
            color: #374151;
            margin-bottom: 5px;
        }

        .form-input {
            width: 100%;
            padding: 10px 12px;
            border: 2px solid #e5e7eb;
            border-radius: 8px;
            font-size: 14px;
            transition: border-color 0.3s ease;
        }

        .form-input:focus {
            outline: none;
            border-color: #3b82f6;
        }

        .btn {
            padding: 10px 20px;
            border: none;
            border-radius: 8px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 14px;
            margin-right: 10px;
        }

        .btn-primary {
            background: #3b82f6;
            color: white;
        }

        .btn-primary:hover {
            background: #2563eb;
            transform: translateY(-2px);
        }

        .btn-secondary {
            background: #6b7280;
            color: white;
        }

        .btn-secondary:hover {
            background: #4b5563;
        }

        .btn-danger {
            background: #ef4444;
            color: white;
        }

        .btn-danger:hover {
            background: #dc2626;
        }

        .add-highlight-btn {
            width: 100%;
            margin-top: 16px;
            padding: 16px 24px;
            font-size: 16px;
            font-weight: 600;
            background: linear-gradient(135deg, #3b82f6 0%, #1d4ed8 100%);
            color: white;
            border: none;
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 12px rgba(59, 130, 246, 0.3);
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }

        .add-highlight-btn:hover {
            background: linear-gradient(135deg, #1d4ed8 0%, #1e40af 100%);
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(59, 130, 246, 0.4);
        }



        .highlight-item {
            background: #f8fafc;
            border: 2px solid #e2e8f0;
            border-radius: 12px;
            padding: 15px;
            margin-bottom: 15px;
            transition: all 0.3s ease;
        }

        .highlight-item:hover {
            border-color: #3b82f6;
        }

        .highlight-preview {
            display: flex;
            align-items: center;
            gap: 15px;
            margin-bottom: 15px;
        }

        .highlight-circle {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            background: linear-gradient(45deg, #3b82f6, #8b5cf6);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            color: white;
            position: relative;
            overflow: hidden;
        }

        .highlight-media {
            width: 100%;
            height: 100%;
            object-fit: cover;
            border-radius: 50%;
        }

        .highlight-info h4 {
            color: #1e293b;
            margin-bottom: 5px;
        }

        .highlight-info p {
            color: #64748b;
            font-size: 14px;
        }

        .highlight-controls {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
            margin-bottom: 15px;
        }

        .stories-section {
            margin-top: 20px;
            padding: 15px;
            background: #f8f9fa;
            border-radius: 8px;
            border: 1px solid #e9ecef;
        }

        .stories-section h5 {
            margin: 0 0 15px 0;
            color: #495057;
            font-size: 14px;
            font-weight: 600;
        }

        .stories-list {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(120px, 1fr));
            gap: 10px;
        }

        .story-item {
            background: white;
            border-radius: 6px;
            padding: 8px;
            border: 1px solid #dee2e6;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 5px;
        }

        .story-preview {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            overflow: hidden;
            display: flex;
            align-items: center;
            justify-content: center;
            background: #f1f3f4;
        }

        .story-media {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .story-info {
            text-align: center;
            font-size: 11px;
        }

        .story-title {
            display: block;
            font-weight: 600;
            color: #495057;
        }

        .story-type {
            display: block;
            color: #6c757d;
            font-size: 10px;
        }

        .story-actions {
            display: flex;
            gap: 5px;
        }

        .btn-sm {
            padding: 4px 8px;
            font-size: 11px;
            border-radius: 4px;
        }

        .stories-count {
            font-size: 12px;
            color: #6c757d;
            margin: 5px 0 0 0;
        }

        .media-type-selector {
            grid-column: 1 / -1;
            margin-bottom: 10px;
        }

        .color-picker-group {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
        }

        .preview-section {
            background: #f8fafc;
            border: 2px solid #e2e8f0;
            border-radius: 12px;
            padding: 20px;
            margin-top: 20px;
        }

        .preview-header {
            font-weight: 600;
            color: #1e293b;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .live-preview {
            border: 1px solid #d1d5db;
            border-radius: 8px;
            padding: 15px;
            background: white;
            min-height: 100px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #6b7280;
        }

        .toggle-switch {
            position: relative;
            display: inline-block;
            width: 50px;
            height: 24px;
        }

        .toggle-switch input {
            opacity: 0;
            width: 0;
            height: 0;
        }

        .slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: #ccc;
            transition: .4s;
            border-radius: 24px;
        }

        .slider:before {
            position: absolute;
            content: "";
            height: 18px;
            width: 18px;
            left: 3px;
            bottom: 3px;
            background-color: white;
            transition: .4s;
            border-radius: 50%;
        }

        input:checked + .slider {
            background-color: #3b82f6;
        }

        input:checked + .slider:before {
            transform: translateX(26px);
        }

        .range-input {
            width: 100%;
            margin: 10px 0;
        }

        .range-value {
            display: inline-block;
            background: #3b82f6;
            color: white;
            padding: 2px 8px;
            border-radius: 4px;
            font-size: 12px;
            margin-left: 10px;
        }

        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            padding: 15px 20px;
            border-radius: 8px;
            color: white;
            font-weight: 500;
            z-index: 1000;
            animation: slideIn 0.3s ease;
        }

        .notification.success {
            background: #10b981;
        }

        .notification.error {
            background: #ef4444;
        }

        .notification.info {
            background: #3b82f6;
        }

        @keyframes slideIn {
            from {
                transform: translateX(100%);
                opacity: 0;
            }
            to {
                transform: translateX(0);
                opacity: 1;
            }
        }

        /* Stories Management Styles */
        .response-area {
            background: #f8f9fa;
            border: 1px solid #e9ecef;
            border-radius: 8px;
            padding: 15px;
            margin-top: 15px;
            font-family: 'Courier New', monospace;
            font-size: 12px;
            white-space: pre-wrap;
            max-height: 200px;
            overflow-y: auto;
        }

        .status-info {
            padding: 15px;
            background: #d1ecf1;
            color: #0c5460;
            border: 1px solid #bee5eb;
            border-radius: 6px;
            text-align: center;
        }

        .stories-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            gap: 15px;
            margin-top: 15px;
        }

        .story-card {
            background: white;
            border: 1px solid #e9ecef;
            border-radius: 8px;
            overflow: hidden;
            transition: transform 0.2s ease, box-shadow 0.2s ease;
        }

        .story-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        }

        .story-header {
            padding: 12px;
            border-bottom: 1px solid #e9ecef;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .story-avatar {
            width: 32px;
            height: 32px;
            border-radius: 50%;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
            font-size: 12px;
        }

        .story-info h4 {
            margin: 0;
            font-size: 14px;
            color: #333;
        }

        .story-info p {
            margin: 0;
            font-size: 11px;
            color: #666;
        }

        .story-content {
            padding: 12px;
        }

        .story-title {
            font-size: 14px;
            font-weight: 600;
            margin-bottom: 6px;
            color: #333;
        }

        .story-description {
            color: #666;
            font-size: 12px;
            margin-bottom: 10px;
        }

        .story-media {
            display: flex;
            gap: 6px;
            flex-wrap: wrap;
        }

        .media-item {
            width: 40px;
            height: 40px;
            border-radius: 4px;
            background: #f8f9fa;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 16px;
            color: #667eea;
        }

        .story-actions {
            padding: 8px 12px;
            border-top: 1px solid #e9ecef;
            display: flex;
            gap: 6px;
        }

        .story-actions button {
            padding: 4px 8px;
            font-size: 11px;
            border-radius: 4px;
        }

        /* Modal Styles */
        .modal {
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0,0,0,0.5);
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .modal-content {
            background-color: white;
            margin: auto;
            padding: 0;
            border-radius: 15px;
            width: 90%;
            max-width: 800px;
            max-height: 90vh;
            overflow-y: auto;
            box-shadow: 0 20px 40px rgba(0,0,0,0.3);
        }

        .modal-header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 20px;
            border-radius: 15px 15px 0 0;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .modal-header h3 {
            margin: 0;
            font-size: 1.5rem;
        }

        .close {
            color: white;
            font-size: 28px;
            font-weight: bold;
            cursor: pointer;
            line-height: 1;
        }

        .close:hover {
            opacity: 0.7;
        }

        .modal-body {
            padding: 20px;
        }

        .looks-list {
            margin-bottom: 30px;
        }

        .add-look-form {
            border-top: 2px solid #e9ecef;
            padding-top: 20px;
        }

        .add-look-form h4 {
            margin-bottom: 15px;
            color: #2d3748;
        }

        .look-item {
            background: #f8f9fa;
            border: 1px solid #e9ecef;
            border-radius: 10px;
            padding: 15px;
            margin-bottom: 15px;
        }

        .look-item:hover {
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
        }
    </style>
</head>
<body>
    <div class="dashboard-container">
        <div class="dashboard-header">
            <h1>
                üëÅÔ∏è Eyejack Admin Dashboard
            </h1>
            <p>Live App Customization & Real-time Control Panel</p>
            <div class="connection-status">
                <div class="status-dot"></div>
                <span id="connectionText">Connected to Backend - Server running on port 3001</span>
            </div>
            <button class="test-connection-btn" onclick="testConnection()">Test Connection</button>
            <button class="save-all-btn" onclick="saveAllChanges()">üíæ Save All Changes</button>
        </div>

        <div class="tabs-container">
            <div class="tabs-header">
                <button class="tab-button active" onclick="switchTab('header')">üè† Header & Branding</button>
                <button class="tab-button" onclick="switchTab('theme')">üé® Theme & Colors</button>
                <button class="tab-button" onclick="switchTab('banners')">üì¢ Banners & Sliders</button>
                <!-- <button class="tab-button" onclick="switchTab('highlights')">‚ú® Highlights</button> -->
                <button class="tab-button" onclick="switchTab('collections')">üì± Collections</button>
                <button class="tab-button" onclick="switchTab('glasses')">üëì Glasses Categories</button>
                <button class="tab-button" onclick="switchTab('featured-products')">üé¨ Featured Products</button>
                <button class="tab-button" onclick="switchTab('new-arrivals')">üÜï New Arrivals</button>
                <button class="tab-button" onclick="switchTab('exclusive')">‚≠ê Exclusive</button>
                <button class="tab-button" onclick="switchTab('mood-look')">üòä Mood Look</button>
                <button class="tab-button" onclick="switchTab('most-loved')">‚ù§Ô∏è Most Loved</button>
                <button class="tab-button" onclick="switchTab('products')">üõçÔ∏è Products</button>
                <button class="tab-button" onclick="switchTab('buttons')">üîò Buttons & Actions</button>
                <button class="tab-button" onclick="switchTab('advanced')">‚öôÔ∏è Advanced Settings</button>
            </div>

            <!-- Header & Branding Tab -->
            <div id="header-tab" class="tab-content active">
                <div class="section-grid">
                    <div class="customization-card">
                        <div class="card-header">
                            <span class="card-icon">üè†</span>
                            <h3 class="card-title">Header Configuration</h3>
                        </div>
                        <div class="color-picker-group">
                            <div class="form-group">
                                <label class="form-label">Background Color</label>
                                <input type="color" class="form-input" id="headerBgColor" value="#ffffff">
                            </div>
                            <div class="form-group">
                                <label class="form-label">Text Color</label>
                                <input type="color" class="form-input" id="headerTextColor" value="#000000">
                            </div>
                        </div>
                        <div class="form-group">
                            <label class="form-label">App Title</label>
                            <input type="text" class="form-input" id="appTitle" value="Eyejack" placeholder="Enter app title">
                        </div>
                        <button class="btn btn-primary" onclick="updateHeader()" style="display: block; width: 100%; margin-top: 20px; padding: 15px; font-size: 16px; font-weight: bold;">üíæ Save Header Changes</button>
                        
                        <div class="preview-section">
                            <div class="preview-header">
                                <span>üì±</span> Live Preview
                            </div>
                            <div class="live-preview" id="headerPreview">
                                Header preview will appear here
                            </div>
                        </div>
                    </div>

                    <div class="customization-card">
                        <div class="card-header">
                            <span class="card-icon">üéØ</span>
                            <h3 class="card-title">Logo & Branding</h3>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Logo URL</label>
                            <input type="url" class="form-input" id="logoUrl" placeholder="https://example.com/logo.png">
                        </div>
                        <div class="form-group">
                            <label class="form-label">Logo Size</label>
                            <input type="range" class="range-input" id="logoSize" min="20" max="100" value="40">
                            <span class="range-value" id="logoSizeValue">40px</span>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Show Logo</label>
                            <label class="toggle-switch">
                                <input type="checkbox" id="showLogo" checked>
                                <span class="slider"></span>
                            </label>
                        </div>
                        <button class="btn btn-primary" onclick="updateLogo()" style="display: block; width: 100%; margin-top: 15px; padding: 12px; font-size: 14px; font-weight: bold;">üñºÔ∏è Save Logo Settings</button>
                    </div>

                    <div class="customization-card">
                        <div class="card-header">
                            <span class="card-icon">üîç</span>
                            <h3 class="card-title">Search & Navigation</h3>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Search Placeholder</label>
                            <input type="text" class="form-input" id="searchPlaceholder" value="Search products..." placeholder="Enter search placeholder">
                        </div>
                        <div class="form-group">
                            <label class="form-label">Show Search Bar</label>
                            <label class="toggle-switch">
                                <input type="checkbox" id="showSearch" checked>
                                <span class="slider"></span>
                            </label>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Show Cart Icon</label>
                            <label class="toggle-switch">
                                <input type="checkbox" id="showCart" checked>
                                <span class="slider"></span>
                            </label>
                        </div>
                        <button class="btn btn-primary" onclick="updateNavigation()" style="display: block; width: 100%; margin-top: 15px; padding: 12px; font-size: 14px; font-weight: bold;">üß≠ Save Navigation Settings</button>
                    </div>
                </div>
            </div>

            <!-- Theme & Colors Tab -->
            <div id="theme-tab" class="tab-content">
                <div class="section-grid">
                    <div class="customization-card">
                        <div class="card-header">
                            <span class="card-icon">üé®</span>
                            <h3 class="card-title">Color Scheme</h3>
                        </div>
                        <div class="color-picker-group">
                            <div class="form-group">
                                <label class="form-label">Primary Color</label>
                                <input type="color" class="form-input" id="primaryColor" value="#3b82f6">
                            </div>
                            <div class="form-group">
                                <label class="form-label">Secondary Color</label>
                                <input type="color" class="form-input" id="secondaryColor" value="#8b5cf6">
                            </div>
                        </div>
                        <div class="color-picker-group">
                            <div class="form-group">
                                <label class="form-label">Accent Color</label>
                                <input type="color" class="form-input" id="accentColor" value="#10b981">
                            </div>
                            <div class="form-group">
                                <label class="form-label">Background Color</label>
                                <input type="color" class="form-input" id="backgroundColor" value="#ffffff">
                            </div>
                        </div>
                        <button class="btn btn-primary" onclick="updateTheme()" style="display: block; width: 100%; margin-top: 20px; padding: 15px; font-size: 16px; font-weight: bold; background: #10b981;">üé® Save Theme Changes</button>
                    </div>

                    <div class="customization-card">
                        <div class="card-header">
                            <span class="card-icon">üåô</span>
                            <h3 class="card-title">Dark Mode</h3>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Enable Dark Mode</label>
                            <label class="toggle-switch">
                                <input type="checkbox" id="darkMode">
                                <span class="slider"></span>
                            </label>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Auto Dark Mode</label>
                            <label class="toggle-switch">
                                <input type="checkbox" id="autoDarkMode">
                                <span class="slider"></span>
                            </label>
                        </div>
                        <button class="btn btn-primary" onclick="updateDarkMode()">Update Dark Mode</button>
                    </div>

                    <div class="customization-card">
                        <div class="card-header">
                            <span class="card-icon">üìù</span>
                            <h3 class="card-title">Typography</h3>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Font Family</label>
                            <select class="form-input" id="fontFamily">
                                <option value="Inter">Inter</option>
                                <option value="Roboto">Roboto</option>
                                <option value="Open Sans">Open Sans</option>
                                <option value="Poppins">Poppins</option>
                                <option value="Montserrat">Montserrat</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Base Font Size</label>
                            <input type="range" class="range-input" id="fontSize" min="12" max="20" value="16">
                            <span class="range-value" id="fontSizeValue">16px</span>
                        </div>
                        <button class="btn btn-primary" onclick="updateTypography()">Update Typography</button>
                    </div>
                </div>
            </div>

            <!-- Banners & Sliders Tab -->
            <div id="banners-tab" class="tab-content">
                <div class="section-grid">
                    <div class="customization-card">
                        <div class="card-header">
                            <span class="card-icon">üì¢</span>
                            <h3 class="card-title">Announcement Bar</h3>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Enable Announcement</label>
                            <label class="toggle-switch">
                                <input type="checkbox" id="enableAnnouncement" checked>
                                <span class="slider"></span>
                            </label>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Announcement Text</label>
                            <input type="text" class="form-input" id="announcementText" value="üéâ Welcome to our store! Free shipping on orders over ‚Çπ50!" placeholder="Enter announcement text">
                        </div>
                        <div class="color-picker-group">
                            <div class="form-group">
                                <label class="form-label">Background Color</label>
                                <input type="color" class="form-input" id="announcementBg" value="#2563eb">
                            </div>
                            <div class="form-group">
                                <label class="form-label">Text Color</label>
                                <input type="color" class="form-input" id="announcementTextColor" value="#ffffff">
                            </div>
                        </div>
                        <button class="btn btn-primary" onclick="updateAnnouncement()">Update Announcement</button>
                    </div>

                    <div class="customization-card">
                        <div class="card-header">
                            <span class="card-icon">üñºÔ∏è</span>
                            <h3 class="card-title">Hero Slider</h3>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Auto Play</label>
                            <label class="toggle-switch">
                                <input type="checkbox" id="sliderAutoPlay" checked>
                                <span class="slider"></span>
                            </label>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Auto Play Interval (seconds)</label>
                            <input type="range" class="range-input" id="sliderInterval" min="3" max="10" value="5">
                            <span class="range-value" id="sliderIntervalValue">5s</span>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Show Indicators</label>
                            <label class="toggle-switch">
                                <input type="checkbox" id="sliderIndicators" checked>
                                <span class="slider"></span>
                            </label>
                        </div>
                        <button class="btn btn-primary" onclick="updateSlider()">Update Slider</button>
                        <button class="btn btn-secondary" onclick="addSliderItem()">Add Slide</button>
                        
                        <div id="sliderItemsList">
                            <!-- Dynamic slider items will be loaded here -->
                        </div>
                    </div>
                </div>
            </div>

            <!-- Highlights Tab (DISABLED) -->
            <!-- <div id="highlights-tab" class="tab-content">
                <div class="section-grid">
                    <div class="customization-card">
                        <div class="card-header">
                            <span class="card-icon">üìñ</span>
                            <h3 class="card-title">Instagram-Style Stories</h3>
                        </div>
                        <div class="form-group">
                            <label class="form-label">User ID (for testing)</label>
                            <input type="text" id="storyUserId" class="form-input" placeholder="Enter user ID for story creation">
                            <button class="btn btn-secondary" onclick="createTestUser()" style="margin-top: 5px;">
                                <span>üë§</span>
                                <span>Create Test User</span>
                            </button>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Story Title</label>
                            <input type="text" id="storyTitle" class="form-input" placeholder="Enter story title">
                        </div>
                        <div class="form-group">
                            <label class="form-label">Story Description</label>
                            <textarea id="storyDescription" class="form-input" rows="3" placeholder="Enter story description"></textarea>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Media Files</label>
                            <input type="file" id="storyMediaFiles" class="form-input" multiple accept="image/*,video/*">
                            <small class="form-help">Select multiple images or videos for the story</small>
                        </div>
                        <button class="btn btn-primary" onclick="createStoryWithMedia()">
                            <span>üìñ</span>
                            <span>Create Story with Media</span>
                        </button>
                        <button class="btn btn-secondary" onclick="getAllStories()">
                            <span>üìã</span>
                            <span>View All Stories</span>
                        </button>
                        <div id="storyResponse" class="response-area" style="display: none;"></div>
                    </div>

                    <div class="customization-card">
                        <div class="card-header">
                            <span class="card-icon">üé¨</span>
                            <h3 class="card-title">Stories Display</h3>
                        </div>
                        <div id="storiesDisplay">
                            <div class="status-info">Click "View All Stories" to load stories here</div>
                        </div>
                    </div>
                </div>

                <div class="customization-card">
                    <div class="card-header">
                        <span class="card-icon">‚ú®</span>
                        <h3 class="card-title">Instagram-Style Highlights</h3>
                    </div>
                    <div id="highlightsItemsList">
                    </div>
                </div>
            </div> -->



            <!-- Collections Tab -->
            <div id="collections-tab" class="tab-content">
                <div class="customization-card">
                    <div class="card-header">
                        <span class="card-icon">üì±</span>
                        <h3 class="card-title">Collections Management</h3>
                    </div>
                    <div id="collectionsItemsList">
                        <!-- Dynamic collection items will be loaded here -->
                    </div>
                    <button class="btn btn-primary add-highlight-btn" onclick="addCollectionItem()">
                        <span>‚ûï</span>
                        <span>Add New Collection</span>
                    </button>
                </div>
            </div>

            <!-- Glasses Categories Tab -->
            <div id="glasses-tab" class="tab-content">
                <div class="section-grid">
                    <!-- Eyeglasses Section -->
                    <div class="customization-card">
                        <div class="card-header">
                            <span class="card-icon">üëì</span>
                            <h3 class="card-title">Eyeglasses Management</h3>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Section Title</label>
                            <input type="text" class="form-input" id="eyeglassesTitle" value="Eyeglasses" placeholder="Enter section title">
                        </div>
                        <div class="form-group">
                            <label class="form-label">Enable Section</label>
                            <label class="toggle-switch">
                                <input type="checkbox" id="eyeglassesEnabled" checked>
                                <span class="slider"></span>
                            </label>
                        </div>
                        <div id="eyeglassesCategoriesList">
                            <!-- Dynamic eyeglasses categories will be loaded here -->
                        </div>
                        <button class="btn btn-primary" onclick="addEyeglassesCategory()">
                            <span>‚ûï</span>
                            <span>Add Category</span>
                        </button>
                        <button class="btn btn-secondary" onclick="updateEyeglassesSection()">
                            <span>üíæ</span>
                            <span>Save Eyeglasses Settings</span>
                        </button>
                    </div>

                    <!-- Sunglasses Section -->
                    <div class="customization-card">
                        <div class="card-header">
                            <span class="card-icon">üï∂Ô∏è</span>
                            <h3 class="card-title">Sunglasses Management</h3>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Section Title</label>
                            <input type="text" class="form-input" id="sunglassesTitle" value="Sunglasses" placeholder="Enter section title">
                        </div>
                        <div class="form-group">
                            <label class="form-label">Enable Section</label>
                            <label class="toggle-switch">
                                <input type="checkbox" id="sunglassesEnabled" checked>
                                <span class="slider"></span>
                            </label>
                        </div>
                        <div id="sunglassesCategoriesList">
                            <!-- Dynamic sunglasses categories will be loaded here -->
                        </div>
                        <button class="btn btn-primary" onclick="addSunglassesCategory()">
                            <span>‚ûï</span>
                            <span>Add Category</span>
                        </button>
                        <button class="btn btn-secondary" onclick="updateSunglassesSection()">
                            <span>üíæ</span>
                            <span>Save Sunglasses Settings</span>
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Featured Products Tab -->
    <div id="featured-products-tab" class="tab-content">
        <div class="section-grid">
            <!-- Featured Products Settings -->
            <div class="customization-card">
                <div class="card-header">
                    <span class="card-icon">üé¨</span>
                    <h3 class="card-title">Featured Products Settings</h3>
                </div>
                <div class="form-group">
                    <label class="form-label">Section Title</label>
                    <input type="text" class="form-input" id="featuredProductsTitle" value="Featured Products" placeholder="Enter section title">
                </div>
                <div class="form-group">
                    <label class="form-label">Section Subtitle</label>
                    <input type="text" class="form-input" id="featuredProductsSubtitle" value="Discover our products through video" placeholder="Enter section subtitle">
                </div>
                <div class="form-group">
                    <label class="form-label">Enable Section</label>
                    <label class="toggle-switch">
                        <input type="checkbox" id="featuredProductsEnabled" checked>
                        <span class="slider"></span>
                    </label>
                </div>
                <button class="btn btn-secondary" onclick="updateFeaturedProductsSettings()">
                    <span>üíæ</span>
                    <span>Save Settings</span>
                </button>
            </div>

            <!-- Featured Products Management -->
            <div class="customization-card">
                <div class="card-header">
                    <span class="card-icon">üìπ</span>
                    <h3 class="card-title">Featured Products Management</h3>
                </div>
                <div id="featuredProductsList">
                    <!-- Dynamic featured products will be loaded here -->
                </div>
                <button class="btn btn-primary" onclick="addFeaturedProduct()">
                    <span>‚ûï</span>
                    <span>Add New Product</span>
                </button>
            </div>
        </div>
    </div>

    <!-- New Arrivals Tab -->
    <div id="new-arrivals-tab" class="tab-content">
        <div class="section-grid">
            <!-- New Arrivals Settings -->
            <div class="customization-card">
                <div class="card-header">
                    <span class="card-icon">üÜï</span>
                    <h3 class="card-title">New Arrivals Settings</h3>
                </div>
                <div class="form-group">
                    <label class="form-label">Section Title</label>
                    <input type="text" class="form-input" id="newArrivalsTitle" value="New Arrivals" placeholder="Enter section title">
                </div>
                <div class="form-group">
                    <label class="form-label">Section Subtitle</label>
                    <input type="text" class="form-input" id="newArrivalsSubtitle" value="Discover our latest products through video" placeholder="Enter section subtitle">
                </div>
                <div class="form-group">
                    <label class="form-label">Enable Section</label>
                    <label class="toggle-switch">
                        <input type="checkbox" id="newArrivalsEnabled" checked>
                        <span class="slider"></span>
                    </label>
                </div>
                <button class="btn btn-secondary" onclick="updateNewArrivalsSettings()">
                    <span>üíæ</span>
                    <span>Save Settings</span>
                </button>
            </div>

            <!-- New Arrivals Management -->
            <div class="customization-card">
                <div class="card-header">
                    <span class="card-icon">üìπ</span>
                    <h3 class="card-title">New Arrivals Management</h3>
                </div>
                <div id="newArrivalsList">
                    <!-- Dynamic new arrivals will be loaded here -->
                </div>
                <button class="btn btn-primary" onclick="addNewArrival()">
                    <span>‚ûï</span>
                    <span>Add New Product</span>
                </button>
            </div>
        </div>
    </div>

    <!-- Exclusive Tab -->
    <div id="exclusive-tab" class="tab-content">
        <div class="section-grid">
            <!-- Exclusive Settings -->
            <div class="customization-card">
                <div class="card-header">
                    <span class="card-icon">‚≠ê</span>
                    <h3 class="card-title">Exclusive Settings</h3>
                </div>
                <div class="form-group">
                    <label class="form-label">Section Title</label>
                    <input type="text" class="form-input" id="exclusiveTitle" value="Exclusively at GOEYE" placeholder="Enter section title">
                </div>
                <div class="form-group">
                    <label class="form-label">Section Subtitle</label>
                    <input type="text" class="form-input" id="exclusiveSubtitle" value="Get the perfect vision and style" placeholder="Enter section subtitle">
                </div>
                <div class="form-group">
                    <label class="form-label">Border Color</label>
                    <input type="color" class="form-input" id="exclusiveBorderColor" value="#fd7f6f">
                </div>
                <div class="form-group">
                    <label class="form-label">Enable Section</label>
                    <label class="toggle-switch">
                        <input type="checkbox" id="exclusiveEnabled" checked>
                        <span class="slider"></span>
                    </label>
                </div>
                <button class="btn btn-secondary" onclick="updateExclusiveSettings()">
                    <span>üíæ</span>
                    <span>Save Settings</span>
                </button>
            </div>

            <!-- Exclusive Products Management -->
            <div class="customization-card">
                <div class="card-header">
                    <span class="card-icon">üìπ</span>
                    <h3 class="card-title">Exclusive Products Management</h3>
                </div>
                <div id="exclusiveList">
                    <!-- Dynamic exclusive products will be loaded here -->
                </div>
                <button class="btn btn-primary" onclick="addExclusiveProduct()">
                    <span>‚ûï</span>
                    <span>Add New Product</span>
                </button>
            </div>
        </div>
    </div>

    <!-- Mood Look Tab -->
    <div id="mood-look-tab" class="tab-content">
        <div class="section-grid">
            <!-- Mood Look Settings -->
            <div class="customization-card">
                <div class="card-header">
                    <span class="card-icon">üòä</span>
                    <h3 class="card-title">Mood Look Settings</h3>
                </div>
                <div class="form-group">
                    <label class="form-label">Section Title</label>
                    <input type="text" class="form-input" id="moodLookTitle" value="Today's mood" placeholder="Enter section title">
                </div>
                <div class="form-group">
                    <label class="form-label">Section Highlight</label>
                    <input type="text" class="form-input" id="moodLookHighlight" value="Look" placeholder="Enter section highlight">
                </div>
                <div class="form-group">
                    <label class="form-label">Section Subtitle</label>
                    <input type="text" class="form-input" id="moodLookSubtitle" value="Discover every look, for every style" placeholder="Enter section subtitle">
                </div>
                <div class="form-group">
                    <label class="form-label">Enable Section</label>
                    <label class="toggle-switch">
                        <input type="checkbox" id="moodLookEnabled" checked>
                        <span class="slider"></span>
                    </label>
                </div>
                <button class="btn btn-secondary" onclick="updateMoodLookSettings()">
                    <span>üíæ</span>
                    <span>Save Settings</span>
                </button>
            </div>

            <!-- Mood Look Categories Management -->
            <div class="customization-card">
                <div class="card-header">
                    <span class="card-icon">üìÇ</span>
                    <h3 class="card-title">Mood Look Categories</h3>
                </div>
                <div id="moodLookCategoriesList">
                    <!-- Dynamic categories will be loaded here -->
                </div>
                <button class="btn btn-primary" onclick="addMoodLookCategory()">
                    <span>‚ûï</span>
                    <span>Add New Category</span>
                </button>
            </div>
        </div>
    </div>

    <!-- Most Loved Tab -->
    <div id="most-loved-tab" class="tab-content">
        <div class="section-grid">
            <!-- Most Loved Settings -->
            <div class="customization-card">
                <div class="card-header">
                    <span class="card-icon">‚ù§Ô∏è</span>
                    <h3 class="card-title">Most Loved Settings</h3>
                </div>
                <div class="form-group">
                    <label class="form-label">Section Title</label>
                    <input type="text" class="form-input" id="mostLovedTitle" value="Most Loved" placeholder="Enter section title">
                </div>
                <div class="form-group">
                    <label class="form-label">Title Font Size</label>
                    <input type="text" class="form-input" id="mostLovedTitleFontSize" value="1.8rem" placeholder="e.g., 1.8rem, 24px">
                </div>
                <div class="form-group">
                    <label class="form-label">Title Font Color</label>
                    <input type="color" class="form-input" id="mostLovedTitleFontColor" value="#2d3748">
                </div>
                <div class="form-group">
                    <label class="form-label">Title Font Family</label>
                    <select class="form-input" id="mostLovedTitleFontFamily">
                        <option value="-apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif">System Default</option>
                        <option value="Arial, sans-serif">Arial</option>
                        <option value="Helvetica, sans-serif">Helvetica</option>
                        <option value="Georgia, serif">Georgia</option>
                        <option value="Times New Roman, serif">Times New Roman</option>
                        <option value="Verdana, sans-serif">Verdana</option>
                    </select>
                </div>
                <div class="form-group">
                    <label class="form-label">Section Subtitle</label>
                    <input type="text" class="form-input" id="mostLovedSubtitle" value="Customers favourite listed every 15 days" placeholder="Enter section subtitle">
                </div>
                <div class="form-group">
                    <label class="form-label">Subtitle Font Size</label>
                    <input type="text" class="form-input" id="mostLovedSubtitleFontSize" value="1rem" placeholder="e.g., 1rem, 16px">
                </div>
                <div class="form-group">
                    <label class="form-label">Subtitle Font Color</label>
                    <input type="color" class="form-input" id="mostLovedSubtitleFontColor" value="#718096">
                </div>
                <div class="form-group">
                    <label class="form-label">Subtitle Font Family</label>
                    <select class="form-input" id="mostLovedSubtitleFontFamily">
                        <option value="-apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif">System Default</option>
                        <option value="Arial, sans-serif">Arial</option>
                        <option value="Helvetica, sans-serif">Helvetica</option>
                        <option value="Georgia, serif">Georgia</option>
                        <option value="Times New Roman, serif">Times New Roman</option>
                        <option value="Verdana, sans-serif">Verdana</option>
                    </select>
                </div>
                <div class="form-group">
                    <label class="form-label">Show Carousel Dots</label>
                    <label class="toggle-switch">
                        <input type="checkbox" id="mostLovedShowDots" checked>
                        <span class="slider"></span>
                    </label>
                </div>
                <div class="form-group">
                    <label class="form-label">Enable Autoplay</label>
                    <label class="toggle-switch">
                        <input type="checkbox" id="mostLovedAutoplay" checked>
                        <span class="slider"></span>
                    </label>
                </div>
                <div class="form-group">
                    <label class="form-label">Autoplay Interval (milliseconds)</label>
                    <input type="number" class="form-input" id="mostLovedAutoplayInterval" value="3000" min="1000" max="10000" step="500">
                    <small style="color: #666;">1000ms = 1 second. Recommended: 3000-5000ms</small>
                </div>
                <div class="form-group">
                    <label class="form-label">Enable Section</label>
                    <label class="toggle-switch">
                        <input type="checkbox" id="mostLovedEnabled" checked>
                        <span class="slider"></span>
                    </label>
                </div>
                <button class="btn btn-secondary" onclick="updateMostLovedSettings()">
                    <span>üíæ</span>
                    <span>Save Settings</span>
                </button>
            </div>

            <!-- Most Loved Products Management -->
            <div class="customization-card">
                <div class="card-header">
                    <span class="card-icon">üì¶</span>
                    <h3 class="card-title">Most Loved Products</h3>
                </div>
                <div id="mostLovedProductsList">
                    <!-- Dynamic products will be loaded here -->
                </div>
                <button class="btn btn-primary" onclick="addMostLovedProduct()">
                    <span>‚ûï</span>
                    <span>Add New Product</span>
                </button>
            </div>
                </div>
            </div>

            <!-- Products Tab -->
            <div id="products-tab" class="tab-content">
                <div class="section-grid">
                    <div class="customization-card">
                        <div class="card-header">
                            <span class="card-icon">üõçÔ∏è</span>
                            <h3 class="card-title">Product Display</h3>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Products Per Row</label>
                            <input type="range" class="range-input" id="productsPerRow" min="1" max="4" value="2">
                            <span class="range-value" id="productsPerRowValue">2</span>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Show Product Ratings</label>
                            <label class="toggle-switch">
                                <input type="checkbox" id="showRatings" checked>
                                <span class="slider"></span>
                            </label>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Show Add to Cart</label>
                            <label class="toggle-switch">
                                <input type="checkbox" id="showAddToCart" checked>
                                <span class="slider"></span>
                            </label>
                        </div>
                        <button class="btn btn-primary" onclick="updateProductDisplay()">Update Display</button>
                    </div>

                    <div class="customization-card">
                        <div class="card-header">
                            <span class="card-icon">üè∑Ô∏è</span>
                            <h3 class="card-title">Product Categories</h3>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Enable Categories</label>
                            <label class="toggle-switch">
                                <input type="checkbox" id="enableCategories" checked>
                                <span class="slider"></span>
                            </label>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Category Layout</label>
                            <select class="form-input" id="categoryLayout">
                                <option value="grid">Grid</option>
                                <option value="horizontal">Horizontal Scroll</option>
                                <option value="list">List</option>
                            </select>
                        </div>
                        <button class="btn btn-primary" onclick="updateCategories()">Update Categories</button>
                    </div>
                </div>
            </div>

            <!-- Buttons & Actions Tab -->
            <div id="buttons-tab" class="tab-content">
                <div class="section-grid">
                    <div class="customization-card">
                        <div class="card-header">
                            <span class="card-icon">üîò</span>
                            <h3 class="card-title">Button Styles</h3>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Button Style</label>
                            <select class="form-input" id="buttonStyle">
                                <option value="rounded">Rounded</option>
                                <option value="square">Square</option>
                                <option value="pill">Pill</option>
                            </select>
                        </div>
                        <div class="color-picker-group">
                            <div class="form-group">
                                <label class="form-label">Primary Button Color</label>
                                <input type="color" class="form-input" id="primaryButtonColor" value="#3b82f6">
                            </div>
                            <div class="form-group">
                                <label class="form-label">Button Text Color</label>
                                <input type="color" class="form-input" id="buttonTextColor" value="#ffffff">
                            </div>
                        </div>
                        <button class="btn btn-primary" onclick="updateButtonStyles()">Update Buttons</button>
                    </div>

                    <div class="customization-card">
                        <div class="card-header">
                            <span class="card-icon">üì±</span>
                            <h3 class="card-title">Bottom Navigation</h3>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Enable Bottom Nav</label>
                            <label class="toggle-switch">
                                <input type="checkbox" id="enableBottomNav" checked>
                                <span class="slider"></span>
                            </label>
                        </div>
                        <div class="color-picker-group">
                            <div class="form-group">
                                <label class="form-label">Selected Color</label>
                                <input type="color" class="form-input" id="bottomNavSelected" value="#3b82f6">
                            </div>
                            <div class="form-group">
                                <label class="form-label">Unselected Color</label>
                                <input type="color" class="form-input" id="bottomNavUnselected" value="#6b7280">
                            </div>
                        </div>
                        <button class="btn btn-primary" onclick="updateBottomNav()">Update Navigation</button>
                    </div>
                </div>
            </div>

            <!-- Advanced Settings Tab -->
            <div id="advanced-tab" class="tab-content">
                <div class="section-grid">
                    <div class="customization-card">
                        <div class="card-header">
                            <span class="card-icon">‚öôÔ∏è</span>
                            <h3 class="card-title">Performance Settings</h3>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Enable Lazy Loading</label>
                            <label class="toggle-switch">
                                <input type="checkbox" id="lazyLoading" checked>
                                <span class="slider"></span>
                            </label>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Image Compression</label>
                            <input type="range" class="range-input" id="imageCompression" min="50" max="100" value="80">
                            <span class="range-value" id="imageCompressionValue">80%</span>
                        </div>
                        <button class="btn btn-primary" onclick="updatePerformance()">Update Settings</button>
                    </div>

                    <div class="customization-card">
                        <div class="card-header">
                            <span class="card-icon">üîí</span>
                            <h3 class="card-title">Security & Privacy</h3>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Enable Analytics</label>
                            <label class="toggle-switch">
                                <input type="checkbox" id="enableAnalytics" checked>
                                <span class="slider"></span>
                            </label>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Cookie Consent</label>
                            <label class="toggle-switch">
                                <input type="checkbox" id="cookieConsent" checked>
                                <span class="slider"></span>
                            </label>
                        </div>
                        <button class="btn btn-primary" onclick="updateSecurity()">Update Security</button>
                    </div>

                    <div class="customization-card">
                        <div class="card-header">
                            <span class="card-icon">üíæ</span>
                            <h3 class="card-title">Backup & Export</h3>
                        </div>
                        <div class="form-group">
                            <button class="btn btn-secondary" onclick="exportSettings()">Export Settings</button>
                            <button class="btn btn-secondary" onclick="importSettings()">Import Settings</button>
                        </div>
                        <div class="form-group">
                            <button class="btn btn-primary" onclick="backupData()">Create Backup</button>
                            <button class="btn btn-danger" onclick="resetSettings()">Reset to Default</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="/socket.io/socket.io.js"></script>
    <script>
        // Initialize Socket.IO connection
        const socket = io();
        let isConnected = false;

        // Connection event handlers
        socket.on('connect', function() {
            console.log('‚úÖ Connected to backend');
            isConnected = true;
            updateConnectionStatus(true);
            
            // Authenticate as admin
            socket.emit('authenticate', {
                userId: 'admin123',
                userType: 'admin'
            });
        });

        socket.on('disconnect', function() {
            console.log('‚ùå Disconnected from backend');
            isConnected = false;
            updateConnectionStatus(false);
        });

        socket.on('authenticated', function(data) {
            console.log('üë§ Authenticated as:', data.userType);
            showNotification('Connected to backend successfully!', 'success');
        });

        // Listen for customization updates
        socket.on('customization:updated', function(data) {
            console.log('üîÑ Customization updated:', data);
            if (data.section === 'highlights') {
                renderHighlightItems(data.data.items || []);
            } else if (data.section === 'collections') {
                renderCollectionItems(data.data.items || []);
            }
        });

        // Update connection status indicator
        function updateConnectionStatus(connected) {
            const statusDot = document.querySelector('.status-dot');
            const statusText = document.querySelector('.connection-status span');
            
            if (connected) {
                statusDot.style.background = '#4ade80';
                statusText.textContent = 'Connected to Backend - Ready for live updates';
            } else {
                statusDot.style.background = '#ef4444';
                statusText.textContent = 'Disconnected from Backend';
            }
        }

        // Test connection function
        function testConnection() {
            console.log('üß™ Testing connection...');
            
            // Send a test header update
            socket.emit('customization:update', {
                section: 'header',
                data: {
                    backgroundColor: '#ff6b6b',
                    textColor: '#ffffff',
                    title: 'Connection Test - ' + new Date().toLocaleTimeString()
                }
            });
            
            showNotification('Test update sent! Check your mobile app for a red header.', 'info');
        }

        // Save all changes function
        function saveAllChanges() {
            console.log('üíæ Saving all changes...');
            
            // Collect all current form data
            const allChanges = {};
            
            // Header changes
            const headerBgColor = document.getElementById('headerBgColor')?.value;
            const headerTextColor = document.getElementById('headerTextColor')?.value;
            const appTitle = document.getElementById('appTitle')?.value;
            
            if (headerBgColor || headerTextColor || appTitle) {
                allChanges.header = {
                    backgroundColor: headerBgColor || '#ffffff',
                    textColor: headerTextColor || '#000000',
                    title: appTitle || 'Eyejack'
                };
            }
            
            // Theme changes
            const primaryColor = document.getElementById('primaryColor')?.value;
            const secondaryColor = document.getElementById('secondaryColor')?.value;
            const accentColor = document.getElementById('accentColor')?.value;
            const backgroundColor = document.getElementById('backgroundColor')?.value;
            
            if (primaryColor || secondaryColor || accentColor || backgroundColor) {
                allChanges.theme = {
                    primaryColor: primaryColor || '#007bff',
                    secondaryColor: secondaryColor || '#6c757d',
                    accentColor: accentColor || '#28a745',
                    backgroundColor: backgroundColor || '#ffffff'
                };
            }
            
            // Send all changes
            Object.keys(allChanges).forEach(section => {
                socket.emit('customization:update', {
                    section: section,
                    data: allChanges[section]
                });
            });
            
            showNotification('‚úÖ All changes saved successfully!', 'success');
        }

        // Tab switching functionality
        function switchTab(tabName) {
            // Hide all tab contents
            const tabContents = document.querySelectorAll('.tab-content');
            tabContents.forEach(tab => tab.classList.remove('active'));
            
            // Remove active class from all tab buttons
            const tabButtons = document.querySelectorAll('.tab-button');
            tabButtons.forEach(btn => btn.classList.remove('active'));
            
            // Show selected tab content
            const selectedTab = document.getElementById(tabName + '-tab');
            if (selectedTab) {
                selectedTab.classList.add('active');
            }
            
            // Add active class to clicked button
            event.target.classList.add('active');
            
            // Load specific data based on tab
            if (tabName === 'glasses') {
                loadGlassesData();
            } else if (tabName === 'collections') {
                loadCollectionItems();
            } else if (tabName === 'featured-products') {
                loadFeaturedProductsData();
            } else if (tabName === 'new-arrivals') {
                loadNewArrivalsData();
            } else if (tabName === 'exclusive') {
                loadExclusiveData();
            } else if (tabName === 'mood-look') {
                loadMoodLookData();
            } else if (tabName === 'most-loved') {
                loadMostLovedData();
            // } else if (tabName === 'highlights') {
            //     loadHighlightItems();
            }
        }

        // Notification system
        function showNotification(message, type = 'info') {
            const notification = document.createElement('div');
            notification.className = `notification ${type}`;
            notification.textContent = message;
            document.body.appendChild(notification);
            
            setTimeout(() => {
                notification.remove();
            }, 3000);
        }

        // Range input handlers
        document.addEventListener('DOMContentLoaded', function() {
            // Logo size range
            const logoSizeRange = document.getElementById('logoSize');
            const logoSizeValue = document.getElementById('logoSizeValue');
            if (logoSizeRange && logoSizeValue) {
                logoSizeRange.addEventListener('input', function() {
                    logoSizeValue.textContent = this.value + 'px';
                });
            }

            // Font size range
            const fontSizeRange = document.getElementById('fontSize');
            const fontSizeValue = document.getElementById('fontSizeValue');
            if (fontSizeRange && fontSizeValue) {
                fontSizeRange.addEventListener('input', function() {
                    fontSizeValue.textContent = this.value + 'px';
                });
            }

            // Slider interval range
            const sliderIntervalRange = document.getElementById('sliderInterval');
            const sliderIntervalValue = document.getElementById('sliderIntervalValue');
            if (sliderIntervalRange && sliderIntervalValue) {
                sliderIntervalRange.addEventListener('input', function() {
                    sliderIntervalValue.textContent = this.value + 's';
                });
            }

            // Products per row range
            const productsPerRowRange = document.getElementById('productsPerRow');
            const productsPerRowValue = document.getElementById('productsPerRowValue');
            if (productsPerRowRange && productsPerRowValue) {
                productsPerRowRange.addEventListener('input', function() {
                    productsPerRowValue.textContent = this.value;
                });
            }

            // Image compression range
            const imageCompressionRange = document.getElementById('imageCompression');
            const imageCompressionValue = document.getElementById('imageCompressionValue');
            if (imageCompressionRange && imageCompressionValue) {
                imageCompressionRange.addEventListener('input', function() {
                    imageCompressionValue.textContent = this.value + '%';
                });
            }

            // Load initial data
            setTimeout(loadCollectionItems, 1000);
            // setTimeout(loadHighlightItems, 1000); // DISABLED
            
            // Show collections tab by default after loading
            setTimeout(() => {
                console.log('üîÑ Switching to collections tab...');
                switchTab('collections');
            }, 2000);
        });

        // Header customization functions
        function updateHeader() {
            const bgColor = document.getElementById('headerBgColor').value;
            const textColor = document.getElementById('headerTextColor').value;
            const title = document.getElementById('appTitle').value;
            
            console.log('üîÑ Sending header update:', { bgColor, textColor, title });
            
            socket.emit('customization:update', {
                section: 'header',
                data: {
                    backgroundColor: bgColor,
                    textColor: textColor,
                    title: title
                }
            });
            
            showNotification('Header updated successfully! Check your mobile app for changes.', 'success');
        }

        function updateLogo() {
            const logoUrl = document.getElementById('logoUrl').value;
            const logoSize = document.getElementById('logoSize').value;
            const showLogo = document.getElementById('showLogo').checked;
            
            socket.emit('customization:update', {
                section: 'logo',
                data: {
                    logoUrl: logoUrl,
                    logoSize: logoSize,
                    showLogo: showLogo
                }
            });
            
            showNotification('Logo updated successfully!', 'success');
        }

        function updateNavigation() {
            const searchPlaceholder = document.getElementById('searchPlaceholder').value;
            const showSearch = document.getElementById('showSearch').checked;
            const showCart = document.getElementById('showCart').checked;
            
            socket.emit('customization:update', {
                section: 'navigation',
                data: {
                    searchPlaceholder: searchPlaceholder,
                    showSearch: showSearch,
                    showCart: showCart
                }
            });
            
            showNotification('Navigation updated successfully!', 'success');
        }

        function updateTheme() {
            const primaryColor = document.getElementById('primaryColor').value;
            const secondaryColor = document.getElementById('secondaryColor').value;
            const accentColor = document.getElementById('accentColor').value;
            const backgroundColor = document.getElementById('backgroundColor').value;
            
            console.log('üé® Sending theme update:', { primaryColor, secondaryColor, accentColor, backgroundColor });
            
            socket.emit('customization:update', {
                section: 'theme',
                data: {
                    primaryColor: primaryColor,
                    secondaryColor: secondaryColor,
                    accentColor: accentColor,
                    backgroundColor: backgroundColor
                }
            });
            
            showNotification('Theme updated successfully! Check your mobile app for color changes.', 'success');
        }

        function updateDarkMode() {
            const darkMode = document.getElementById('darkMode').checked;
            const autoDarkMode = document.getElementById('autoDarkMode').checked;
            
            socket.emit('customization:update', {
                section: 'darkMode',
                data: {
                    enabled: darkMode,
                    auto: autoDarkMode
                }
            });
            
            showNotification('Dark mode settings updated!', 'success');
        }

        function updateTypography() {
            const fontFamily = document.getElementById('fontFamily').value;
            const fontSize = document.getElementById('fontSize').value;
            
            socket.emit('customization:update', {
                section: 'typography',
                data: {
                    fontFamily: fontFamily,
                    fontSize: fontSize
                }
            });
            
            showNotification('Typography updated successfully!', 'success');
        }

        function updateAnnouncement() {
            const enabled = document.getElementById('enableAnnouncement').checked;
            const text = document.getElementById('announcementText').value;
            const bgColor = document.getElementById('announcementBg').value;
            const textColor = document.getElementById('announcementTextColor').value;
            
            socket.emit('customization:update', {
                section: 'announcement',
                data: {
                    enabled: enabled,
                    text: text,
                    backgroundColor: bgColor,
                    textColor: textColor
                }
            });
            
            showNotification('Announcement updated successfully!', 'success');
        }

        function updateSlider() {
            const autoPlay = document.getElementById('sliderAutoPlay').checked;
            const interval = document.getElementById('sliderInterval').value;
            const indicators = document.getElementById('sliderIndicators').checked;
            
            socket.emit('customization:update', {
                section: 'slider',
                data: {
                    autoPlay: autoPlay,
                    interval: interval,
                    showIndicators: indicators
                }
            });
            
            showNotification('Slider settings updated!', 'success');
        }

        function addSliderItem() {
            const imageUrl = prompt('Enter slide image URL:');
            if (!imageUrl) return;
            
            const title = prompt('Enter slide title:') || '';
            const subtitle = prompt('Enter slide subtitle:') || '';
            
            socket.emit('customization:update', {
                section: 'sliderItems',
                action: 'add',
                data: {
                    imageUrl: imageUrl,
                    title: title,
                    subtitle: subtitle
                }
            });
            
            showNotification('Slide added successfully!', 'success');
        }

        function updateProductDisplay() {
            const productsPerRow = document.getElementById('productsPerRow').value;
            const showRatings = document.getElementById('showRatings').checked;
            const showAddToCart = document.getElementById('showAddToCart').checked;
            
            socket.emit('customization:update', {
                section: 'productDisplay',
                data: {
                    productsPerRow: productsPerRow,
                    showRatings: showRatings,
                    showAddToCart: showAddToCart
                }
            });
            
            showNotification('Product display updated!', 'success');
        }

        function updateCategories() {
            const enabled = document.getElementById('enableCategories').checked;
            const layout = document.getElementById('categoryLayout').value;
            
            socket.emit('customization:update', {
                section: 'categories',
                data: {
                    enabled: enabled,
                    layout: layout
                }
            });
            
            showNotification('Categories updated!', 'success');
        }

        function updateButtonStyles() {
            const style = document.getElementById('buttonStyle').value;
            const primaryColor = document.getElementById('primaryButtonColor').value;
            const textColor = document.getElementById('buttonTextColor').value;
            
            socket.emit('customization:update', {
                section: 'buttonStyles',
                data: {
                    style: style,
                    primaryColor: primaryColor,
                    textColor: textColor
                }
            });
            
            showNotification('Button styles updated!', 'success');
        }

        function updateBottomNav() {
            const enabled = document.getElementById('enableBottomNav').checked;
            const selectedColor = document.getElementById('bottomNavSelected').value;
            const unselectedColor = document.getElementById('bottomNavUnselected').value;
            
            socket.emit('customization:update', {
                section: 'bottomNav',
                data: {
                    enabled: enabled,
                    selectedColor: selectedColor,
                    unselectedColor: unselectedColor
                }
            });
            
            showNotification('Bottom navigation updated!', 'success');
        }

        function updatePerformance() {
            const lazyLoading = document.getElementById('lazyLoading').checked;
            const imageCompression = document.getElementById('imageCompression').value;
            
            socket.emit('customization:update', {
                section: 'performance',
                data: {
                    lazyLoading: lazyLoading,
                    imageCompression: imageCompression
                }
            });
            
            showNotification('Performance settings updated!', 'success');
        }

        function updateSecurity() {
            const analytics = document.getElementById('enableAnalytics').checked;
            const cookieConsent = document.getElementById('cookieConsent').checked;
            
            socket.emit('customization:update', {
                section: 'security',
                data: {
                    analytics: analytics,
                    cookieConsent: cookieConsent
                }
            });
            
            showNotification('Security settings updated!', 'success');
        }

        function exportSettings() {
            showNotification('Exporting settings...', 'info');
            // Implementation for export
        }

        function importSettings() {
            showNotification('Import functionality coming soon!', 'info');
            // Implementation for import
        }

        function backupData() {
            showNotification('Creating backup...', 'info');
            // Implementation for backup
        }

        function resetSettings() {
            if (confirm('Are you sure you want to reset all settings to default? This cannot be undone.')) {
                showNotification('Resetting to default settings...', 'info');
                // Implementation for reset
            }
        }

        // Stories Management Functions
        async function createTestUser() {
            try {
                const response = await fetch('http://localhost:3002/api/users', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        username: 'testuser_' + Date.now(),
                        email: `test${Date.now()}@example.com`,
                        password: 'password123'
                    })
                });

                const data = await response.json();
                
                if (data.success) {
                    document.getElementById('storyUserId').value = data.data.id;
                    showNotification('Test user created successfully! User ID: ' + data.data.id, 'success');
                } else {
                    showNotification('Error creating test user: ' + data.message, 'error');
                }
            } catch (error) {
                showNotification('Error creating test user: ' + error.message, 'error');
            }
        }

        async function createStoryWithMedia() {
            const userId = document.getElementById('storyUserId').value;
            const title = document.getElementById('storyTitle').value;
            const description = document.getElementById('storyDescription').value;
            const files = document.getElementById('storyMediaFiles').files;

            if (!userId || !title) {
                showNotification('Please provide User ID and Story Title', 'error');
                return;
            }

            try {
                // First create the story
                const storyResponse = await fetch('http://localhost:3002/api/stories', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({ userId, title, description })
                });

                const storyData = await storyResponse.json();
                
                if (!storyData.success) {
                    showNotification('Error creating story: ' + storyData.message, 'error');
                    return;
                }

                const storyId = storyData.data.storyId;
                showNotification('Story created successfully!', 'success');

                // If media files are selected, upload them
                if (files.length > 0) {
                    const formData = new FormData();
                    for (let file of files) {
                        formData.append('media', file);
                    }

                    const mediaResponse = await fetch(`http://localhost:3002/api/stories/${storyId}/media`, {
                        method: 'POST',
                        body: formData
                    });

                    const mediaData = await mediaResponse.json();
                    
                    if (mediaData.success) {
                        showNotification(`Story created with ${mediaData.data.media.length} media files!`, 'success');
                        showStoryResponse(mediaData);
                    } else {
                        showNotification('Story created but media upload failed: ' + mediaData.message, 'error');
                        showStoryResponse(storyData);
                    }
                } else {
                    showStoryResponse(storyData);
                }

                // Clear form
                document.getElementById('storyTitle').value = '';
                document.getElementById('storyDescription').value = '';
                document.getElementById('storyMediaFiles').value = '';

            } catch (error) {
                console.error('Error creating story:', error);
                showNotification('Error creating story: ' + error.message, 'error');
            }
        }

        async function getAllStories() {
            try {
                const response = await fetch('http://localhost:3002/api/stories');
                const data = await response.json();
                
                if (data.success) {
                    showNotification(`Found ${data.data.stories.length} stories`, 'success');
                    displayStories(data.data.stories);
                    showStoryResponse(data);
                } else {
                    showNotification('Error fetching stories: ' + data.message, 'error');
                }
            } catch (error) {
                console.error('Error fetching stories:', error);
                showNotification('Error fetching stories: ' + error.message, 'error');
            }
        }

        function displayStories(stories) {
            const displayArea = document.getElementById('storiesDisplay');
            
            if (stories.length === 0) {
                displayArea.innerHTML = '<div class="status-info">No stories found</div>';
                return;
            }

            displayArea.innerHTML = `
                <div class="stories-grid">
                    ${stories.map(story => `
                        <div class="story-card">
                            <div class="story-header">
                                <div class="story-avatar">
                                    ${story.user?.username?.charAt(0) || 'U'}
                                </div>
                                <div class="story-info">
                                    <h4>${story.user?.username || 'Unknown User'}</h4>
                                    <p>${new Date(story.createdAt).toLocaleDateString()}</p>
                                </div>
                            </div>
                            <div class="story-content">
                                <div class="story-title">${story.title}</div>
                                <div class="story-description">${story.description || 'No description'}</div>
                                <div class="story-media">
                                    ${story.media.map(media => `
                                        <div class="media-item">
                                            ${media.type === 'image' ? 'üñºÔ∏è' : 'üé•'}
                                        </div>
                                    `).join('')}
                                </div>
                            </div>
                            <div class="story-actions">
                                <button class="btn btn-sm btn-secondary" onclick="viewStory('${story.storyId}')">View</button>
                                <button class="btn btn-sm btn-danger" onclick="deleteStory('${story.storyId}')">Delete</button>
                            </div>
                        </div>
                    `).join('')}
                </div>
            `;
        }

        function showStoryResponse(data) {
            const responseArea = document.getElementById('storyResponse');
            responseArea.textContent = JSON.stringify(data, null, 2);
            responseArea.style.display = 'block';
        }

        async function viewStory(storyId) {
            try {
                const response = await fetch(`http://localhost:3002/api/stories/${storyId}`);
                const data = await response.json();
                
                if (data.success) {
                    showStoryResponse(data);
                    showNotification('Story details loaded', 'success');
                } else {
                    showNotification('Error loading story: ' + data.message, 'error');
                }
            } catch (error) {
                showNotification('Error loading story: ' + error.message, 'error');
            }
        }

        async function deleteStory(storyId) {
            if (!confirm('Are you sure you want to delete this story?')) {
                return;
            }

            try {
                const response = await fetch(`http://localhost:3002/api/stories/${storyId}`, {
                    method: 'DELETE'
                });
                const data = await response.json();
                
                if (data.success) {
                    showNotification('Story deleted successfully', 'success');
                    getAllStories(); // Refresh the list
                } else {
                    showNotification('Error deleting story: ' + data.message, 'error');
                }
            } catch (error) {
                showNotification('Error deleting story: ' + error.message, 'error');
            }
        }

        // Highlights management functions (DISABLED)
        /*
        function loadHighlightItems() {
            console.log('üîÑ Loading highlight items...');
            fetch('/api/customization/highlights')
                .then(response => response.json())
                .then(data => {
                    console.log('üì¶ Loaded highlights:', data);
                    if (data.success && data.data && data.data.items) {
                        renderHighlightItems(data.data.items);
                    }
                })
                .catch(error => {
                    console.error('‚ùå Error loading highlights:', error);
                });
        }

        function renderHighlightItems(items) {
            console.log('üé® Rendering highlight items:', items);
            const container = document.getElementById('highlightsItemsList');
            if (!container) {
                console.error('‚ùå Highlights container not found!');
                return;
            }
            container.innerHTML = '';

            items.forEach(item => {
                const itemDiv = document.createElement('div');
                itemDiv.className = 'highlight-item';
                
                // Initialize stories array if it doesn't exist
                if (!item.stories) {
                    item.stories = [];
                }
                
                const hasMedia = (item.imageUrl && item.imageUrl !== '') || (item.videoUrl && item.videoUrl !== '');
                const mediaType = item.mediaType || 'image';
                
                let mediaPreview = '';
                if (hasMedia) {
                    if (mediaType === 'video' && item.videoUrl) {
                        mediaPreview = `<video src="${item.videoUrl}" class="highlight-media" controls muted></video>`;
                    } else if (item.imageUrl) {
                        mediaPreview = `<img src="${item.imageUrl}" class="highlight-media" alt="${item.label}">`;
                    }
                } else {
                    const icon = mediaType === 'video' ? 'üé•' : 'üì∑';
                    mediaPreview = `<div style="display: flex; align-items: center; justify-content: center; font-size: 24px; color: #64748b;">${icon}</div>`;
                }

                // Generate stories HTML
                let storiesHTML = '';
                if (item.stories && item.stories.length > 0) {
                    storiesHTML = `
                        <div class="stories-section">
                            <h5>üìñ Stories (${item.stories.length})</h5>
                            <div class="stories-list">
                                ${item.stories.map((story, index) => `
                                    <div class="story-item" data-story-index="${index}">
                                        <div class="story-preview">
                                            ${story.mediaType === 'video' ? 
                                                `<video src="${story.mediaUrl}" class="story-media" controls muted></video>` :
                                                `<img src="${story.mediaUrl}" class="story-media" alt="Story ${index + 1}">`
                                            }
                                        </div>
                                        <div class="story-info">
                                            <span class="story-title">Story ${index + 1}</span>
                                            <span class="story-type">${story.mediaType}</span>
                                        </div>
                                        <div class="story-actions">
                                            <button class="btn btn-sm btn-secondary" onclick="editStory('${item.id}', ${index})">‚úèÔ∏è</button>
                                            <button class="btn btn-sm btn-danger" onclick="deleteStory('${item.id}', ${index})">üóëÔ∏è</button>
                                        </div>
                                    </div>
                                `).join('')}
                            </div>
                        </div>
                    `;
                }

                itemDiv.innerHTML = `
                    <div class="highlight-preview">
                        <div class="highlight-circle">
                            ${mediaPreview}
                        </div>
                        <div class="highlight-info">
                            <h4>${item.label}</h4>
                            <p>${hasMedia ? (mediaType === 'video' ? 'Video highlight' : 'Image highlight') : 'No media added yet'}</p>
                            <p class="stories-count">üìñ ${item.stories ? item.stories.length : 0} stories</p>
                        </div>
                    </div>
                    <div class="media-type-selector">
                        <label class="form-label">Media Type</label>
                        <select class="form-input" onchange="updateHighlightMediaType('${item.id}', this.value)">
                            <option value="image" ${mediaType === 'image' ? 'selected' : ''}>Image</option>
                            <option value="video" ${mediaType === 'video' ? 'selected' : ''}>Video</option>
                        </select>
                    </div>
                    <div class="highlight-controls">
                        <button class="btn btn-primary" onclick="uploadMediaToHighlight('${item.id}', '${mediaType}')">
                            üìÅ Upload ${mediaType === 'video' ? 'Video' : 'Image'}
                        </button>
                        <button class="btn btn-secondary" onclick="addMediaUrlToHighlight('${item.id}', '${mediaType}')">
                            üîó Add URL
                        </button>
                        <button class="btn btn-success" onclick="addStoryToHighlight('${item.id}')">
                            üìñ Add Story
                        </button>
                        <button class="btn btn-danger" onclick="deleteHighlightItem('${item.id}')">
                            üóëÔ∏è Delete
                        </button>
                    </div>
                    ${storiesHTML}
                `;
                
                container.appendChild(itemDiv);
            });

            // Add the "Add New Highlight" button at the end
            const addButton = document.createElement('button');
            addButton.className = 'add-highlight-btn';
            addButton.onclick = addHighlightItem;
            addButton.innerHTML = `
                <span>‚ûï</span>
                <span>Add New Highlight</span>
            `;

            container.appendChild(addButton);
        }

        function addHighlightItem() {
            console.log('‚ûï Adding new highlight item...');
            const label = prompt('Enter highlight label:');
            if (!label) return;

            const newItem = {
                label: label,
                imageUrl: '',
                videoUrl: '',
                mediaType: 'image'
            };

            fetch('/api/customization/highlights/items', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify(newItem)
            })
            .then(response => response.json())
            .then(data => {
                console.log('‚úÖ Highlight added:', data);
                if (data.success) {
                    showNotification('Highlight added successfully!', 'success');
                    loadHighlightItems(); // Reload the list
                } else {
                    showNotification('Error adding highlight: ' + data.message, 'error');
                }
            })
            .catch(error => {
                console.error('‚ùå Error adding highlight:', error);
                showNotification('Error adding highlight', 'error');
            });
        }

        function updateHighlightMediaType(itemId, mediaType) {
            fetch(`/api/customization/highlights/items/${itemId}`, {
                method: 'PUT',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify({ mediaType: mediaType })
            })
            .then(response => response.json())
            .then(data => {
                if (data.success) {
                    showNotification('Media type updated!', 'success');
                    loadHighlightItems(); // Reload to update UI
                }
            })
            .catch(error => {
                console.error('Error updating media type:', error);
            });
        }

        function addMediaUrlToHighlight(itemId, mediaType) {
            const url = prompt(`Enter ${mediaType} URL:`);
            if (!url) return;

            const updateData = { mediaType: mediaType };
            if (mediaType === 'video') {
                updateData.videoUrl = url;
                updateData.imageUrl = ''; // Clear image URL
            } else {
                updateData.imageUrl = url;
                updateData.videoUrl = ''; // Clear video URL
            }

            fetch(`/api/customization/highlights/items/${itemId}`, {
                method: 'PUT',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify(updateData)
            })
            .then(response => response.json())
            .then(data => {
                if (data.success) {
                    showNotification(`${mediaType} URL updated!`, 'success');
                    loadHighlightItems(); // Reload to show new media
                } else {
                    showNotification('Error updating URL: ' + data.message, 'error');
                }
            })
            .catch(error => {
                console.error('Error updating URL:', error);
                showNotification('Error updating URL', 'error');
            });
        }

        function uploadMediaToHighlight(itemId, mediaType) {
            const input = document.createElement('input');
            input.type = 'file';
            input.accept = mediaType === 'video' ? 'video/*' : 'image/*';
            input.onchange = function(event) {
                const file = event.target.files[0];
                if (file) {
                    handleHighlightMediaUpload(file, itemId, mediaType);
                }
            };
            input.click();
        }

        function handleHighlightMediaUpload(file, itemId, mediaType) {
            // Validate file type
            const isVideo = mediaType === 'video';
            const validTypes = isVideo ? ['video/mp4', 'video/webm', 'video/ogg'] : ['image/jpeg', 'image/png', 'image/gif', 'image/webp'];
            
            if (!validTypes.includes(file.type)) {
                showNotification(`Invalid file type. Please select a valid ${mediaType} file.`, 'error');
                return;
            }

            // Validate file size (10MB for video, 5MB for image)
            const maxSize = isVideo ? 10 * 1024 * 1024 : 5 * 1024 * 1024;
            if (file.size > maxSize) {
                const maxSizeMB = isVideo ? 10 : 5;
                showNotification(`File too large. Maximum size is ${maxSizeMB}MB.`, 'error');
                return;
            }

            const formData = new FormData();
            formData.append('media', file);
            formData.append('mediaType', mediaType);

            fetch(`/api/customization/highlights/items/${itemId}/upload`, {
                method: 'POST',
                body: formData
            })
            .then(response => response.json())
            .then(data => {
                if (data.success) {
                    showNotification(`${mediaType} uploaded successfully!`, 'success');
                    loadHighlightItems(); // Reload to show new media
                } else {
                    showNotification('Upload failed: ' + data.message, 'error');
                }
            })
            .catch(error => {
                console.error('Upload error:', error);
                showNotification('Upload failed', 'error');
            });
        }

        function deleteHighlightItem(itemId) {
            if (!confirm('Are you sure you want to delete this highlight?')) return;

            fetch(`/api/customization/highlights/items/${itemId}`, {
                method: 'DELETE'
            })
            .then(response => response.json())
            .then(data => {
                if (data.success) {
                    showNotification('Highlight deleted successfully!', 'success');
                    loadHighlightItems(); // Reload the list
                } else {
                    showNotification('Error deleting highlight: ' + data.message, 'error');
                }
            })
            .catch(error => {
                console.error('Error deleting highlight:', error);
                showNotification('Error deleting highlight', 'error');
            });
        }

        // Story management functions
        function addStoryToHighlight(highlightId) {
            const storyTitle = prompt('Enter story title:');
            if (!storyTitle) return;

            const mediaType = prompt('Enter media type (image/video):', 'image');
            if (!mediaType || !['image', 'video'].includes(mediaType)) {
                showNotification('Invalid media type. Use "image" or "video".', 'error');
                return;
            }

            const mediaUrl = prompt(`Enter ${mediaType} URL:`);
            if (!mediaUrl) return;

            const newStory = {
                title: storyTitle,
                mediaType: mediaType,
                mediaUrl: mediaUrl,
                createdAt: new Date().toISOString()
            };

            fetch(`/api/customization/highlights/items/${highlightId}/stories`, {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify(newStory)
            })
            .then(response => response.json())
            .then(data => {
                if (data.success) {
                    showNotification('Story added successfully!', 'success');
                    loadHighlightItems();
                } else {
                    showNotification('Error adding story: ' + data.message, 'error');
                }
            })
            .catch(error => {
                console.error('Error adding story:', error);
                showNotification('Error adding story', 'error');
            });
        }

        function editStory(highlightId, storyIndex) {
            const newTitle = prompt('Enter new story title:');
            if (!newTitle) return;

            const newMediaType = prompt('Enter media type (image/video):', 'image');
            if (!newMediaType || !['image', 'video'].includes(newMediaType)) {
                showNotification('Invalid media type. Use "image" or "video".', 'error');
                return;
            }

            const newMediaUrl = prompt(`Enter ${newMediaType} URL:`);
            if (!newMediaUrl) return;

            const updatedStory = {
                title: newTitle,
                mediaType: newMediaType,
                mediaUrl: newMediaUrl,
                updatedAt: new Date().toISOString()
            };

            fetch(`/api/customization/highlights/items/${highlightId}/stories/${storyIndex}`, {
                method: 'PUT',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify(updatedStory)
            })
            .then(response => response.json())
            .then(data => {
                if (data.success) {
                    showNotification('Story updated successfully!', 'success');
                    loadHighlightItems();
                } else {
                    showNotification('Error updating story: ' + data.message, 'error');
                }
            })
            .catch(error => {
                console.error('Error updating story:', error);
                showNotification('Error updating story', 'error');
            });
        }

        function deleteStory(highlightId, storyIndex) {
            if (!confirm('Are you sure you want to delete this story?')) return;

            fetch(`/api/customization/highlights/items/${highlightId}/stories/${storyIndex}`, {
                method: 'DELETE'
            })
            .then(response => response.json())
            .then(data => {
                if (data.success) {
                    showNotification('Story deleted successfully!', 'success');
                    loadHighlightItems();
                } else {
                    showNotification('Error deleting story: ' + data.message, 'error');
                }
            })
            .catch(error => {
                console.error('Error deleting story:', error);
                showNotification('Error deleting story', 'error');
            });
        }
        */

        // Collections management functions
        function loadCollectionItems() {
            console.log('üîÑ Loading collection items...');
            fetch('/api/customization/collections')
                .then(response => {
                    console.log('üì° Response status:', response.status);
                    return response.json();
                })
                .then(data => {
                    console.log('üì¶ Loaded collections:', data);
                    if (data.success && data.data && data.data.items) {
                        console.log('üéØ Rendering', data.data.items.length, 'collection items');
                        renderCollectionItems(data.data.items);
                    } else {
                        console.log('‚ö†Ô∏è No collection items found or invalid data structure');
                    }
                })
                .catch(error => {
                    console.error('‚ùå Error loading collections:', error);
                });
        }

        function renderCollectionItems(items) {
            console.log('üé® Rendering collection items:', items);
            const container = document.getElementById('collectionsItemsList');
            if (!container) {
                console.error('‚ùå Collections container not found!');
                return;
            }
            
            console.log('üì¶ Container found, clearing and adding', items.length, 'items');
            container.innerHTML = '';

            items.forEach((item, index) => {
                console.log('üéØ Rendering item', index + 1, ':', item);
                const itemDiv = document.createElement('div');
                itemDiv.className = 'highlight-item';
                
                itemDiv.innerHTML = `
                    <div class="highlight-preview">
                        <img src="${item.imageUrl || '/placeholder-image.jpg'}" class="highlight-media" alt="${item.title}" style="border-radius: 8px;">
                        <div class="highlight-info">
                            <h4>${item.title}</h4>
                            <p>Click URL: ${item.clickUrl || 'Not set'}</p>
                        </div>
                    </div>
                    <div class="highlight-controls">
                        <button class="btn btn-primary" onclick="uploadImageToCollection('${item.id}')">
                            üìÅ Upload Image
                        </button>
                        <button class="btn btn-secondary" onclick="addImageUrlToCollection('${item.id}')">
                            üîó Add Image URL
                        </button>
                        <button class="btn btn-secondary" onclick="setCollectionClickUrl('${item.id}')">
                            üîó Set Click URL
                        </button>
                        <button class="btn btn-danger" onclick="deleteCollectionItem('${item.id}')">
                            üóëÔ∏è Delete
                        </button>
                    </div>
                `;
                
                container.appendChild(itemDiv);
            });
        }

        function addCollectionItem() {
            const title = prompt('Enter collection title:');
            if (!title) return;

            fetch('/api/customization/collections/items', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify({ title: title })
            })
            .then(response => response.json())
            .then(data => {
                if (data.success) {
                    showNotification('Collection added successfully!', 'success');
                    loadCollectionItems();
                } else {
                    showNotification('Error adding collection: ' + data.message, 'error');
                }
            })
            .catch(error => {
                console.error('Error adding collection:', error);
                showNotification('Error adding collection', 'error');
            });
        }

        function addImageUrlToCollection(itemId) {
            const url = prompt('Enter image URL:');
            if (!url) return;

            fetch(`/api/customization/collections/items/${itemId}`, {
                method: 'PUT',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify({ imageUrl: url })
            })
            .then(response => response.json())
            .then(data => {
                if (data.success) {
                    showNotification('Image URL updated!', 'success');
                    loadCollectionItems();
                } else {
                    showNotification('Error updating URL: ' + data.message, 'error');
                }
            })
            .catch(error => {
                console.error('Error updating URL:', error);
                showNotification('Error updating URL', 'error');
            });
        }

        function setCollectionClickUrl(itemId) {
            const url = prompt('Enter click URL:');
            if (!url) return;

            fetch(`/api/customization/collections/items/${itemId}`, {
                method: 'PUT',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify({ clickUrl: url })
            })
            .then(response => response.json())
            .then(data => {
                if (data.success) {
                    showNotification('Click URL updated!', 'success');
                    loadCollectionItems();
                } else {
                    showNotification('Error updating URL: ' + data.message, 'error');
                }
            })
            .catch(error => {
                console.error('Error updating URL:', error);
                showNotification('Error updating URL', 'error');
            });
        }

        function uploadImageToCollection(itemId) {
            const input = document.createElement('input');
            input.type = 'file';
            input.accept = 'image/*';
            input.onchange = function(event) {
                const file = event.target.files[0];
                if (file) {
                    handleCollectionImageUpload(file, itemId);
                }
            };
            input.click();
        }

        function handleCollectionImageUpload(file, itemId) {
            const validTypes = ['image/jpeg', 'image/png', 'image/gif', 'image/webp'];
            
            if (!validTypes.includes(file.type)) {
                showNotification('Invalid file type. Please select a valid image file.', 'error');
                return;
            }

            if (file.size > 5 * 1024 * 1024) {
                showNotification('File too large. Maximum size is 5MB.', 'error');
                return;
            }

            const formData = new FormData();
            formData.append('image', file);

            fetch(`/api/customization/collections/items/${itemId}/upload`, {
                method: 'POST',
                body: formData
            })
            .then(response => response.json())
            .then(data => {
                if (data.success) {
                    showNotification('Image uploaded successfully!', 'success');
                    loadCollectionItems();
                } else {
                    showNotification('Upload failed: ' + data.message, 'error');
                }
            })
            .catch(error => {
                console.error('Upload error:', error);
                showNotification('Upload failed', 'error');
            });
        }

        function deleteCollectionItem(itemId) {
            if (!confirm('Are you sure you want to delete this collection?')) return;

            fetch(`/api/customization/collections/items/${itemId}`, {
                method: 'DELETE'
            })
            .then(response => response.json())
            .then(data => {
                if (data.success) {
                    showNotification('Collection deleted successfully!', 'success');
                    loadCollectionItems();
                } else {
                    showNotification('Error deleting collection: ' + data.message, 'error');
                }
            })
            .catch(error => {
                console.error('Error deleting collection:', error);
                showNotification('Error deleting collection', 'error');
            });
        }

        // Glasses management functions
        function loadGlassesData() {
            console.log('üîÑ Loading glasses data...');
            fetch('/api/customization/glasses')
                .then(response => response.json())
                .then(data => {
                    if (data.success && data.data) {
                        console.log('üì¶ Loaded glasses data:', data.data);
                        populateGlassesForm(data.data);
                    }
                })
                .catch(error => {
                    console.error('‚ùå Error loading glasses data:', error);
                });
        }

        function populateGlassesForm(glassesData) {
            // Populate Eyeglasses form
            if (glassesData.eyeglasses) {
                document.getElementById('eyeglassesTitle').value = glassesData.eyeglasses.title || 'Eyeglasses';
                document.getElementById('eyeglassesEnabled').checked = glassesData.eyeglasses.enabled !== false;
                renderGlassesCategories('eyeglasses', glassesData.eyeglasses.categories || []);
            }

            // Populate Sunglasses form
            if (glassesData.sunglasses) {
                document.getElementById('sunglassesTitle').value = glassesData.sunglasses.title || 'Sunglasses';
                document.getElementById('sunglassesEnabled').checked = glassesData.sunglasses.enabled !== false;
                renderGlassesCategories('sunglasses', glassesData.sunglasses.categories || []);
            }
        }

        function renderGlassesCategories(type, categories) {
            const container = document.getElementById(`${type}CategoriesList`);
            if (!container) return;

            container.innerHTML = '';
            
            categories.forEach(category => {
                const categoryDiv = document.createElement('div');
                categoryDiv.className = 'highlight-item';
                categoryDiv.innerHTML = `
                    <div class="highlight-preview">
                        <img src="${category.imageUrl || '/placeholder-image.jpg'}" class="highlight-media" alt="${category.name}" style="border-radius: 8px;">
                        <div class="highlight-info">
                            <h4>${category.name}</h4>
                            <p>Order: ${category.order}</p>
                        </div>
                    </div>
                    <div class="highlight-controls">
                        <button class="btn btn-primary" onclick="uploadGlassesCategoryImage('${type}', '${category.id}')">
                            üìÅ Upload Image
                        </button>
                        <button class="btn btn-info" onclick="uploadGlassesCategoryImageURL('${type}', '${category.id}')">
                            üîó Upload Image URL
                        </button>
                        <button class="btn btn-secondary" onclick="editGlassesCategory('${type}', '${category.id}')">
                            ‚úèÔ∏è Edit
                        </button>
                        <button class="btn btn-danger" onclick="deleteGlassesCategory('${type}', '${category.id}')">
                            üóëÔ∏è Delete
                        </button>
                    </div>
                `;
                container.appendChild(categoryDiv);
            });
        }

        function addEyeglassesCategory() {
            const name = prompt('Enter category name:');
            if (!name) return;

            fetch('/api/customization/glasses/eyeglasses/categories', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify({ name: name })
            })
            .then(response => response.json())
            .then(data => {
                if (data.success) {
                    showNotification('Eyeglasses category added successfully!', 'success');
                    loadGlassesData();
                } else {
                    showNotification('Error adding category: ' + data.message, 'error');
                }
            })
            .catch(error => {
                console.error('Error adding category:', error);
                showNotification('Error adding category', 'error');
            });
        }

        function addSunglassesCategory() {
            const name = prompt('Enter category name:');
            if (!name) return;

            fetch('/api/customization/glasses/sunglasses/categories', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify({ name: name })
            })
            .then(response => response.json())
            .then(data => {
                if (data.success) {
                    showNotification('Sunglasses category added successfully!', 'success');
                    loadGlassesData();
                } else {
                    showNotification('Error adding category: ' + data.message, 'error');
                }
            })
            .catch(error => {
                console.error('Error adding category:', error);
                showNotification('Error adding category', 'error');
            });
        }

        function updateEyeglassesSection() {
            const title = document.getElementById('eyeglassesTitle').value;
            const enabled = document.getElementById('eyeglassesEnabled').checked;

            fetch('/api/customization/glasses/eyeglasses', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify({ title: title, enabled: enabled })
            })
            .then(response => response.json())
            .then(data => {
                if (data.success) {
                    showNotification('Eyeglasses settings updated successfully!', 'success');
                } else {
                    showNotification('Error updating settings: ' + data.message, 'error');
                }
            })
            .catch(error => {
                console.error('Error updating settings:', error);
                showNotification('Error updating settings', 'error');
            });
        }

        function updateSunglassesSection() {
            const title = document.getElementById('sunglassesTitle').value;
            const enabled = document.getElementById('sunglassesEnabled').checked;

            fetch('/api/customization/glasses/sunglasses', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify({ title: title, enabled: enabled })
            })
            .then(response => response.json())
            .then(data => {
                if (data.success) {
                    showNotification('Sunglasses settings updated successfully!', 'success');
                } else {
                    showNotification('Error updating settings: ' + data.message, 'error');
                }
            })
            .catch(error => {
                console.error('Error updating settings:', error);
                showNotification('Error updating settings', 'error');
            });
        }

        function editGlassesCategory(type, categoryId) {
            const newName = prompt('Enter new category name:');
            if (!newName) return;

            fetch(`/api/customization/glasses/${type}/categories/${categoryId}`, {
                method: 'PUT',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify({ name: newName })
            })
            .then(response => response.json())
            .then(data => {
                if (data.success) {
                    showNotification('Category updated successfully!', 'success');
                    loadGlassesData();
                } else {
                    showNotification('Error updating category: ' + data.message, 'error');
                }
            })
            .catch(error => {
                console.error('Error updating category:', error);
                showNotification('Error updating category', 'error');
            });
        }

        function uploadGlassesCategoryImage(type, categoryId) {
            const input = document.createElement('input');
            input.type = 'file';
            input.accept = 'image/*';
            input.onchange = function(event) {
                const file = event.target.files[0];
                if (file) {
                    handleGlassesImageUpload(file, type, categoryId);
                }
            };
            input.click();
        }

        function uploadGlassesCategoryImageURL(type, categoryId) {
            const imageUrl = prompt('Enter image URL:');
            if (!imageUrl) return;

            fetch(`/api/customization/glasses/${type}/categories/${categoryId}/image-url`, {
                method: 'PUT',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify({ imageUrl: imageUrl })
            })
            .then(response => response.json())
            .then(data => {
                if (data.success) {
                    showNotification('Image URL updated successfully!', 'success');
                    loadGlassesData();
                } else {
                    showNotification('Error updating image URL: ' + data.message, 'error');
                }
            })
            .catch(error => {
                console.error('Error updating image URL:', error);
                showNotification('Error updating image URL', 'error');
            });
        }

        function handleGlassesImageUpload(file, type, categoryId) {
            const validTypes = ['image/jpeg', 'image/png', 'image/gif', 'image/webp'];
            
            if (!validTypes.includes(file.type)) {
                showNotification('Invalid file type. Please select a valid image file.', 'error');
                return;
            }

            if (file.size > 5 * 1024 * 1024) {
                showNotification('File too large. Maximum size is 5MB.', 'error');
                return;
            }

            const formData = new FormData();
            formData.append('image', file);

            fetch(`/api/customization/glasses/${type}/categories/${categoryId}/upload`, {
                method: 'POST',
                body: formData
            })
            .then(response => response.json())
            .then(data => {
                if (data.success) {
                    showNotification('Image uploaded successfully!', 'success');
                    loadGlassesData();
                } else {
                    showNotification('Upload failed: ' + data.message, 'error');
                }
            })
            .catch(error => {
                console.error('Upload error:', error);
                showNotification('Upload failed', 'error');
            });
        }

        function deleteGlassesCategory(type, categoryId) {
            if (!confirm('Are you sure you want to delete this category?')) return;

            fetch(`/api/customization/glasses/${type}/categories/${categoryId}`, {
                method: 'DELETE'
            })
            .then(response => response.json())
            .then(data => {
                if (data.success) {
                    showNotification('Category deleted successfully!', 'success');
                    loadGlassesData();
                } else {
                    showNotification('Error deleting category: ' + data.message, 'error');
                }
            })
            .catch(error => {
                console.error('Error deleting category:', error);
                showNotification('Error deleting category', 'error');
            });
        }

        // Featured Products management functions
        function loadFeaturedProductsData() {
            console.log('üîÑ Loading featured products data...');
            fetch('/api/customization/featured-products')
                .then(response => response.json())
                .then(data => {
                    if (data.success && data.data) {
                        console.log('üì¶ Loaded featured products data:', data.data);
                        populateFeaturedProductsForm(data.data);
                    }
                })
                .catch(error => {
                    console.error('‚ùå Error loading featured products data:', error);
                });
        }

        function populateFeaturedProductsForm(featuredData) {
            // Populate form fields
            document.getElementById('featuredProductsTitle').value = featuredData.title || 'Featured Products';
            document.getElementById('featuredProductsSubtitle').value = featuredData.subtitle || 'Discover our products through video';
            document.getElementById('featuredProductsEnabled').checked = featuredData.enabled !== false;
            
            // Render products
            renderFeaturedProducts(featuredData.products || []);
        }

        function renderFeaturedProducts(products) {
            const container = document.getElementById('featuredProductsList');
            if (!container) return;

            container.innerHTML = '';
            
            products.forEach(product => {
                const productDiv = document.createElement('div');
                productDiv.className = 'highlight-item';
                productDiv.innerHTML = `
                    <div class="highlight-preview">
                        <video src="${product.videoUrl || '/placeholder-video.mp4'}" class="highlight-media" muted loop style="border-radius: 8px; width: 100px; height: 100px; object-fit: cover;">
                        </video>
                        <div class="highlight-info">
                            <h4>${product.name}</h4>
                            <p>Order: ${product.order}</p>
                        </div>
                    </div>
                    <div class="highlight-controls">
                        <button class="btn btn-primary" onclick="uploadFeaturedProductVideo('${product.id}')">
                            üìÅ Upload Video
                        </button>
                        <button class="btn btn-secondary" onclick="editFeaturedProduct('${product.id}')">
                            ‚úèÔ∏è Edit
                        </button>
                        <button class="btn btn-danger" onclick="deleteFeaturedProduct('${product.id}')">
                            üóëÔ∏è Delete
                        </button>
                    </div>
                `;
                container.appendChild(productDiv);
            });
        }

        function addFeaturedProduct() {
            const name = prompt('Enter product name:');
            if (!name) return;

            fetch('/api/customization/featured-products/products', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify({ name: name })
            })
            .then(response => response.json())
            .then(data => {
                if (data.success) {
                    showNotification('Featured product added successfully!', 'success');
                    loadFeaturedProductsData();
                } else {
                    showNotification('Error adding product: ' + data.message, 'error');
                }
            })
            .catch(error => {
                console.error('Error adding product:', error);
                showNotification('Error adding product', 'error');
            });
        }

        function updateFeaturedProductsSettings() {
            const title = document.getElementById('featuredProductsTitle').value;
            const subtitle = document.getElementById('featuredProductsSubtitle').value;
            const enabled = document.getElementById('featuredProductsEnabled').checked;

            fetch('/api/customization/featured-products', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify({ title: title, subtitle: subtitle, enabled: enabled })
            })
            .then(response => response.json())
            .then(data => {
                if (data.success) {
                    showNotification('Featured products settings updated successfully!', 'success');
                } else {
                    showNotification('Error updating settings: ' + data.message, 'error');
                }
            })
            .catch(error => {
                console.error('Error updating settings:', error);
                showNotification('Error updating settings', 'error');
            });
        }

        function editFeaturedProduct(productId) {
            const newName = prompt('Enter new product name:');
            if (!newName) return;

            fetch(`/api/customization/featured-products/products/${productId}`, {
                method: 'PUT',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify({ name: newName })
            })
            .then(response => response.json())
            .then(data => {
                if (data.success) {
                    showNotification('Product updated successfully!', 'success');
                    loadFeaturedProductsData();
                } else {
                    showNotification('Error updating product: ' + data.message, 'error');
                }
            })
            .catch(error => {
                console.error('Error updating product:', error);
                showNotification('Error updating product', 'error');
            });
        }

        function uploadFeaturedProductVideo(productId) {
            const input = document.createElement('input');
            input.type = 'file';
            input.accept = 'video/*';
            input.onchange = function(event) {
                const file = event.target.files[0];
                if (file) {
                    handleFeaturedProductVideoUpload(file, productId);
                }
            };
            input.click();
        }

        function handleFeaturedProductVideoUpload(file, productId) {
            const validTypes = ['video/mp4', 'video/webm', 'video/ogg'];
            
            if (!validTypes.includes(file.type)) {
                showNotification('Invalid file type. Please select a valid video file.', 'error');
                return;
            }

            if (file.size > 100 * 1024 * 1024) {
                showNotification('File too large. Maximum size is 100MB.', 'error');
                return;
            }

            const formData = new FormData();
            formData.append('video', file);

            fetch(`/api/customization/featured-products/products/${productId}/upload`, {
                method: 'POST',
                body: formData
            })
            .then(response => response.json())
            .then(data => {
                if (data.success) {
                    showNotification('Video uploaded successfully!', 'success');
                    loadFeaturedProductsData();
                } else {
                    showNotification('Upload failed: ' + data.message, 'error');
                }
            })
            .catch(error => {
                console.error('Upload error:', error);
                showNotification('Upload failed', 'error');
            });
        }

        function deleteFeaturedProduct(productId) {
            if (!confirm('Are you sure you want to delete this product?')) return;

            fetch(`/api/customization/featured-products/products/${productId}`, {
                method: 'DELETE'
            })
            .then(response => response.json())
            .then(data => {
                if (data.success) {
                    showNotification('Product deleted successfully!', 'success');
                    loadFeaturedProductsData();
                } else {
                    showNotification('Error deleting product: ' + data.message, 'error');
                }
            })
            .catch(error => {
                console.error('Error deleting product:', error);
                showNotification('Error deleting product', 'error');
            });
        }

        // New Arrivals management functions
        function loadNewArrivalsData() {
            console.log('üîÑ Loading new arrivals data...');
            fetch('/api/customization/new-arrivals')
                .then(response => response.json())
                .then(data => {
                    if (data.success && data.data) {
                        console.log('üì¶ Loaded new arrivals data:', data.data);
                        populateNewArrivalsForm(data.data);
                    }
                })
                .catch(error => {
                    console.error('‚ùå Error loading new arrivals data:', error);
                });
        }

        function populateNewArrivalsForm(newArrivalsData) {
            // Populate form fields
            document.getElementById('newArrivalsTitle').value = newArrivalsData.title || 'New Arrivals';
            document.getElementById('newArrivalsSubtitle').value = newArrivalsData.subtitle || 'Discover our latest products through video';
            document.getElementById('newArrivalsEnabled').checked = newArrivalsData.enabled !== false;
            
            // Render products
            renderNewArrivals(newArrivalsData.products || []);
        }

        function renderNewArrivals(products) {
            const container = document.getElementById('newArrivalsList');
            if (!container) return;

            container.innerHTML = '';
            
            products.forEach(product => {
                const productDiv = document.createElement('div');
                productDiv.className = 'highlight-item';
                productDiv.innerHTML = `
                    <div class="highlight-preview">
                        <video src="${product.videoUrl || '/placeholder-video.mp4'}" class="highlight-media" muted loop style="border-radius: 8px; width: 100px; height: 100px; object-fit: cover;">
                        </video>
                        <div class="highlight-info">
                            <h4>${product.name}</h4>
                            <p>Order: ${product.order}</p>
                        </div>
                    </div>
                    <div class="highlight-controls">
                        <button class="btn btn-primary" onclick="uploadNewArrivalVideo('${product.id}')">
                            üìÅ Upload Video
                        </button>
                        <button class="btn btn-secondary" onclick="editNewArrival('${product.id}')">
                            ‚úèÔ∏è Edit
                        </button>
                        <button class="btn btn-danger" onclick="deleteNewArrival('${product.id}')">
                            üóëÔ∏è Delete
                        </button>
                    </div>
                `;
                container.appendChild(productDiv);
            });
        }

        function addNewArrival() {
            const name = prompt('Enter product name:');
            if (!name) return;

            fetch('/api/customization/new-arrivals/products', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify({ name: name })
            })
            .then(response => response.json())
            .then(data => {
                if (data.success) {
                    showNotification('New arrival product added successfully!', 'success');
                    loadNewArrivalsData();
                } else {
                    showNotification('Error adding product: ' + data.message, 'error');
                }
            })
            .catch(error => {
                console.error('Error adding product:', error);
                showNotification('Error adding product', 'error');
            });
        }

        function updateNewArrivalsSettings() {
            const title = document.getElementById('newArrivalsTitle').value;
            const subtitle = document.getElementById('newArrivalsSubtitle').value;
            const enabled = document.getElementById('newArrivalsEnabled').checked;

            fetch('/api/customization/new-arrivals', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify({ title: title, subtitle: subtitle, enabled: enabled })
            })
            .then(response => response.json())
            .then(data => {
                if (data.success) {
                    showNotification('New arrivals settings updated successfully!', 'success');
                } else {
                    showNotification('Error updating settings: ' + data.message, 'error');
                }
            })
            .catch(error => {
                console.error('Error updating settings:', error);
                showNotification('Error updating settings', 'error');
            });
        }

        function editNewArrival(productId) {
            const newName = prompt('Enter new product name:');
            if (!newName) return;

            fetch(`/api/customization/new-arrivals/products/${productId}`, {
                method: 'PUT',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify({ name: newName })
            })
            .then(response => response.json())
            .then(data => {
                if (data.success) {
                    showNotification('Product updated successfully!', 'success');
                    loadNewArrivalsData();
                } else {
                    showNotification('Error updating product: ' + data.message, 'error');
                }
            })
            .catch(error => {
                console.error('Error updating product:', error);
                showNotification('Error updating product', 'error');
            });
        }

        function uploadNewArrivalVideo(productId) {
            const input = document.createElement('input');
            input.type = 'file';
            input.accept = 'video/*';
            input.onchange = function(event) {
                const file = event.target.files[0];
                if (file) {
                    handleNewArrivalVideoUpload(file, productId);
                }
            };
            input.click();
        }

        function handleNewArrivalVideoUpload(file, productId) {
            const validTypes = ['video/mp4', 'video/webm', 'video/ogg'];
            
            if (!validTypes.includes(file.type)) {
                showNotification('Invalid file type. Please select a valid video file.', 'error');
                return;
            }

            if (file.size > 100 * 1024 * 1024) {
                showNotification('File too large. Maximum size is 100MB.', 'error');
                return;
            }

            const formData = new FormData();
            formData.append('video', file);

            fetch(`/api/customization/new-arrivals/products/${productId}/upload`, {
                method: 'POST',
                body: formData
            })
            .then(response => response.json())
            .then(data => {
                if (data.success) {
                    showNotification('Video uploaded successfully!', 'success');
                    loadNewArrivalsData();
                } else {
                    showNotification('Upload failed: ' + data.message, 'error');
                }
            })
            .catch(error => {
                console.error('Upload error:', error);
                showNotification('Upload failed', 'error');
            });
        }

        function deleteNewArrival(productId) {
            if (!confirm('Are you sure you want to delete this product?')) return;

            fetch(`/api/customization/new-arrivals/products/${productId}`, {
                method: 'DELETE'
            })
            .then(response => response.json())
            .then(data => {
                if (data.success) {
                    showNotification('Product deleted successfully!', 'success');
                    loadNewArrivalsData();
                } else {
                    showNotification('Error deleting product: ' + data.message, 'error');
                }
            })
            .catch(error => {
                console.error('Error deleting product:', error);
                showNotification('Error deleting product', 'error');
            });
        }

        // Exclusive management functions
        function loadExclusiveData() {
            console.log('üîÑ Loading exclusive data...');
            fetch('/api/customization/exclusive')
                .then(response => response.json())
                .then(data => {
                    if (data.success && data.data) {
                        console.log('üì¶ Loaded exclusive data:', data.data);
                        populateExclusiveForm(data.data);
                    }
                })
                .catch(error => {
                    console.error('‚ùå Error loading exclusive data:', error);
                });
        }

        function populateExclusiveForm(exclusiveData) {
            // Populate form fields
            document.getElementById('exclusiveTitle').value = exclusiveData.title || 'Exclusively at GOEYE';
            document.getElementById('exclusiveSubtitle').value = exclusiveData.subtitle || 'Get the perfect vision and style';
            document.getElementById('exclusiveBorderColor').value = exclusiveData.borderColor || '#fd7f6f';
            document.getElementById('exclusiveEnabled').checked = exclusiveData.enabled !== false;
            
            // Render products
            renderExclusiveProducts(exclusiveData.products || []);
        }

        function renderExclusiveProducts(products) {
            const container = document.getElementById('exclusiveList');
            if (!container) return;

            container.innerHTML = '';
            
            products.forEach(product => {
                const productDiv = document.createElement('div');
                productDiv.className = 'highlight-item';
                productDiv.innerHTML = `
                    <div class="highlight-preview">
                        <video src="${product.videoUrl || '/placeholder-video.mp4'}" class="highlight-media" muted loop style="border-radius: 8px; width: 100px; height: 100px; object-fit: cover;">
                        </video>
                        <div class="highlight-info">
                            <h4>Product ${product.order}</h4>
                            <p>Order: ${product.order}</p>
                        </div>
                    </div>
                    <div class="highlight-controls">
                        <button class="btn btn-primary" onclick="uploadExclusiveVideo('${product.id}')">
                            üìÅ Upload Video
                        </button>
                        <button class="btn btn-info" onclick="uploadExclusiveVideoURL('${product.id}')">
                            üîó Upload Video URL
                        </button>
                        <button class="btn btn-secondary" onclick="editExclusiveProduct('${product.id}')">
                            ‚úèÔ∏è Edit Order
                        </button>
                        <button class="btn btn-danger" onclick="deleteExclusiveProduct('${product.id}')">
                            üóëÔ∏è Delete
                        </button>
                    </div>
                `;
                container.appendChild(productDiv);
            });
        }

        function addExclusiveProduct() {
            const videoUrl = prompt('Enter video URL (or leave empty for default):');
            if (videoUrl === null) return;

            fetch('/api/customization/exclusive/products', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify({ videoUrl: videoUrl || undefined })
            })
            .then(response => response.json())
            .then(data => {
                if (data.success) {
                    showNotification('Exclusive product added successfully!', 'success');
                    loadExclusiveData();
                } else {
                    showNotification('Error adding product: ' + data.message, 'error');
                }
            })
            .catch(error => {
                console.error('Error adding product:', error);
                showNotification('Error adding product', 'error');
            });
        }

        function updateExclusiveSettings() {
            const title = document.getElementById('exclusiveTitle').value;
            const subtitle = document.getElementById('exclusiveSubtitle').value;
            const borderColor = document.getElementById('exclusiveBorderColor').value;
            const enabled = document.getElementById('exclusiveEnabled').checked;

            fetch('/api/customization/exclusive', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify({ title: title, subtitle: subtitle, borderColor: borderColor, enabled: enabled })
            })
            .then(response => response.json())
            .then(data => {
                if (data.success) {
                    showNotification('Exclusive settings updated successfully!', 'success');
                } else {
                    showNotification('Error updating settings: ' + data.message, 'error');
                }
            })
            .catch(error => {
                console.error('Error updating settings:', error);
                showNotification('Error updating settings', 'error');
            });
        }

        function editExclusiveProduct(productId) {
            const newOrder = prompt('Enter new order number:');
            if (!newOrder || isNaN(newOrder)) return;

            fetch(`/api/customization/exclusive/products/${productId}`, {
                method: 'PUT',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify({ order: parseInt(newOrder) })
            })
            .then(response => response.json())
            .then(data => {
                if (data.success) {
                    showNotification('Product order updated successfully!', 'success');
                    loadExclusiveData();
                } else {
                    showNotification('Error updating product: ' + data.message, 'error');
                }
            })
            .catch(error => {
                console.error('Error updating product:', error);
                showNotification('Error updating product', 'error');
            });
        }

        function uploadExclusiveVideo(productId) {
            const input = document.createElement('input');
            input.type = 'file';
            input.accept = 'video/*';
            input.onchange = function(event) {
                const file = event.target.files[0];
                if (file) {
                    handleExclusiveVideoUpload(file, productId);
                }
            };
            input.click();
        }

        function handleExclusiveVideoUpload(file, productId) {
            const validTypes = ['video/mp4', 'video/webm', 'video/ogg'];
            if (!validTypes.includes(file.type)) {
                showNotification('Invalid file type. Please select a valid video file.', 'error');
                return;
            }

            if (file.size > 100 * 1024 * 1024) {
                showNotification('File too large. Maximum size is 100MB.', 'error');
                return;
            }

            const formData = new FormData();
            formData.append('video', file);

            fetch(`/api/customization/exclusive/products/${productId}/upload`, {
                method: 'POST',
                body: formData
            })
            .then(response => response.json())
            .then(data => {
                if (data.success) {
                    showNotification('Video uploaded successfully!', 'success');
                    loadExclusiveData();
                } else {
                    showNotification('Upload failed: ' + data.message, 'error');
                }
            })
            .catch(error => {
                console.error('Upload error:', error);
                showNotification('Upload failed', 'error');
            });
        }

        function uploadExclusiveVideoURL(productId) {
            const videoUrl = prompt('Enter video URL:');
            if (!videoUrl) return;

            fetch(`/api/customization/exclusive/products/${productId}/video-url`, {
                method: 'PUT',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify({ videoUrl: videoUrl })
            })
            .then(response => response.json())
            .then(data => {
                if (data.success) {
                    showNotification('Video URL updated successfully!', 'success');
                    loadExclusiveData();
                } else {
                    showNotification('Error updating video URL: ' + data.message, 'error');
                }
            })
            .catch(error => {
                console.error('Error updating video URL:', error);
                showNotification('Error updating video URL', 'error');
            });
        }

        function deleteExclusiveProduct(productId) {
            if (!confirm('Are you sure you want to delete this product?')) return;

            fetch(`/api/customization/exclusive/products/${productId}`, {
                method: 'DELETE'
            })
            .then(response => response.json())
            .then(data => {
                if (data.success) {
                    showNotification('Product deleted successfully!', 'success');
                    loadExclusiveData();
                } else {
                    showNotification('Error deleting product: ' + data.message, 'error');
                }
            })
            .catch(error => {
                console.error('Error deleting product:', error);
                showNotification('Error deleting product', 'error');
            });
        }

        // Mood Look management functions
        function loadMoodLookData() {
            console.log('üîÑ Loading mood look data...');
            fetch('/api/customization/mood-look')
                .then(response => response.json())
                .then(data => {
                    if (data.success && data.data) {
                        console.log('üì¶ Loaded mood look data:', data.data);
                        populateMoodLookForm(data.data);
                    }
                })
                .catch(error => {
                    console.error('‚ùå Error loading mood look data:', error);
                });
        }

        function populateMoodLookForm(moodData) {
            // Populate form fields
            document.getElementById('moodLookTitle').value = moodData.title || "Today's mood";
            document.getElementById('moodLookHighlight').value = moodData.highlight || 'Look';
            document.getElementById('moodLookSubtitle').value = moodData.subtitle || 'Discover every look, for every style';
            document.getElementById('moodLookEnabled').checked = moodData.enabled !== false;
            
            // Render categories
            renderMoodLookCategories(moodData.categories || []);
        }

        function renderMoodLookCategories(categories) {
            const container = document.getElementById('moodLookCategoriesList');
            if (!container) return;

            container.innerHTML = '';
            
            categories.forEach(category => {
                const categoryDiv = document.createElement('div');
                categoryDiv.className = 'highlight-item';
                categoryDiv.innerHTML = `
                    <div class="highlight-preview">
                        <div class="highlight-info">
                            <h4>${category.title}</h4>
                            <p>Subtitle: ${category.subtitle}</p>
                            <p>Looks: ${category.looks ? category.looks.length : 0}</p>
                        </div>
                    </div>
                    <div class="highlight-controls">
                        <button class="btn btn-secondary" onclick="editMoodLookCategory('${category.id}')">
                            ‚úèÔ∏è Edit Category
                        </button>
                        <button class="btn btn-primary" onclick="manageMoodLookLooks('${category.id}')">
                            üëÅÔ∏è Manage Looks
                        </button>
                        <button class="btn btn-danger" onclick="deleteMoodLookCategory('${category.id}')">
                            üóëÔ∏è Delete
                        </button>
                    </div>
                `;
                container.appendChild(categoryDiv);
            });
        }

        function updateMoodLookSettings() {
            const title = document.getElementById('moodLookTitle').value;
            const highlight = document.getElementById('moodLookHighlight').value;
            const subtitle = document.getElementById('moodLookSubtitle').value;
            const enabled = document.getElementById('moodLookEnabled').checked;

            fetch('/api/customization/mood-look', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify({ title: title, highlight: highlight, subtitle: subtitle, enabled: enabled })
            })
            .then(response => response.json())
            .then(data => {
                if (data.success) {
                    showNotification('Mood look settings updated successfully!', 'success');
                } else {
                    showNotification('Error updating settings: ' + data.message, 'error');
                }
            })
            .catch(error => {
                console.error('Error updating settings:', error);
                showNotification('Error updating settings', 'error');
            });
        }

        function addMoodLookCategory() {
            const title = prompt('Enter category title:');
            if (!title) return;

            const subtitle = prompt('Enter category subtitle:', 'Explore All');
            if (!subtitle) return;

            fetch('/api/customization/mood-look/categories', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify({ title: title, subtitle: subtitle })
            })
            .then(response => response.json())
            .then(data => {
                if (data.success) {
                    showNotification('Category added successfully!', 'success');
                    loadMoodLookData();
                } else {
                    showNotification('Error adding category: ' + data.message, 'error');
                }
            })
            .catch(error => {
                console.error('Error adding category:', error);
                showNotification('Error adding category', 'error');
            });
        }

        function editMoodLookCategory(categoryId) {
            const newTitle = prompt('Enter new category title:');
            if (!newTitle) return;

            const newSubtitle = prompt('Enter new category subtitle:', 'Explore All');
            if (!newSubtitle) return;

            fetch(`/api/customization/mood-look/categories/${categoryId}`, {
                method: 'PUT',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify({ title: newTitle, subtitle: newSubtitle })
            })
            .then(response => response.json())
            .then(data => {
                if (data.success) {
                    showNotification('Category updated successfully!', 'success');
                    loadMoodLookData();
                } else {
                    showNotification('Error updating category: ' + data.message, 'error');
                }
            })
            .catch(error => {
                console.error('Error updating category:', error);
                showNotification('Error updating category', 'error');
            });
        }

        function deleteMoodLookCategory(categoryId) {
            if (!confirm('Are you sure you want to delete this category?')) return;

            fetch(`/api/customization/mood-look/categories/${categoryId}`, {
                method: 'DELETE'
            })
            .then(response => response.json())
            .then(data => {
                if (data.success) {
                    showNotification('Category deleted successfully!', 'success');
                    loadMoodLookData();
                } else {
                    showNotification('Error deleting category: ' + data.message, 'error');
                }
            })
            .catch(error => {
                console.error('Error deleting category:', error);
                showNotification('Error deleting category', 'error');
            });
        }

        function manageMoodLookLooks(categoryId) {
            // Open the looks management modal
            openLooksModal(categoryId);
        }

        function openLooksModal(categoryId) {
            // Create modal HTML
            const modalHTML = `
                <div id="looksModal" class="modal" style="display: block;">
                    <div class="modal-content">
                        <div class="modal-header">
                            <h3>Manage Looks</h3>
                            <span class="close" onclick="closeLooksModal()">&times;</span>
                        </div>
                        <div class="modal-body">
                            <div class="bulk-actions" style="margin-bottom: 20px; padding: 15px; background: #f8f9fa; border-radius: 8px;">
                                <h4 style="margin-bottom: 10px;">Bulk Actions</h4>
                                <button class="btn btn-warning" onclick="bulkUpdateImages('${categoryId}')">üîÑ Update All Selected Images</button>
                                <p style="margin-top: 8px; font-size: 0.9rem; color: #666;">Select multiple images above and click this button to update them all at once.</p>
                            </div>
                            <div class="looks-list" id="looksList">
                                <!-- Looks will be loaded here -->
                            </div>
                            <div class="add-look-form">
                                <h4>Add New Look</h4>
                                <input type="text" id="newLookName" placeholder="Look name" style="width: 100%; margin-bottom: 10px; padding: 8px;">
                                <div style="margin-bottom: 10px;">
                                    <label style="display: block; margin-bottom: 5px; font-weight: bold;">Upload Image:</label>
                                    <input type="file" id="newLookImage" accept="image/*" style="width: 100%; margin-bottom: 10px;">
                                </div>
                                <div style="margin-bottom: 10px;">
                                    <label style="display: block; margin-bottom: 5px; font-weight: bold;">Or Use Image URL:</label>
                                    <input type="url" id="newLookImageUrl" placeholder="https://example.com/image.jpg" style="width: 100%; padding: 8px; border: 1px solid #ddd; border-radius: 4px;">
                                </div>
                                <button class="btn btn-primary" onclick="addNewLook('${categoryId}')">Add Look</button>
                            </div>
                        </div>
                    </div>
                </div>
            `;
            
            // Add modal to page
            document.body.insertAdjacentHTML('beforeend', modalHTML);
            
            // Load existing looks
            loadLooksForCategory(categoryId);
        }

        function closeLooksModal() {
            const modal = document.getElementById('looksModal');
            if (modal) {
                modal.remove();
            }
        }

        function loadLooksForCategory(categoryId) {
            fetch(`/api/customization/mood-look/categories/${categoryId}`)
                .then(response => response.json())
                .then(data => {
                    if (data.success && data.data.looks) {
                        renderLooksList(data.data.looks, categoryId);
                    }
                })
                .catch(error => {
                    console.error('Error loading looks:', error);
                    showNotification('Error loading looks', 'error');
                });
        }

        function renderLooksList(looks, categoryId) {
            const looksList = document.getElementById('looksList');
            if (!looksList) return;

            looksList.innerHTML = '';
            
            looks.forEach(look => {
                const lookDiv = document.createElement('div');
                lookDiv.className = 'look-item';
                lookDiv.style.cssText = 'border: 1px solid #ddd; padding: 15px; margin-bottom: 10px; border-radius: 8px;';
                
                lookDiv.innerHTML = `
                    <div style="display: flex; align-items: center; gap: 15px;">
                        <img src="${look.imageUrl || 'https://via.placeholder.com/100x120?text=No+Image'}" 
                             alt="${look.name}" 
                             style="width: 100px; height: 120px; object-fit: cover; border-radius: 8px;">
                        <div style="flex: 1;">
                            <h4 style="margin: 0 0 10px 0;">${look.name}</h4>
                            <div style="display: flex; gap: 10px; flex-wrap: wrap; margin-bottom: 10px;">
                                <input type="file" id="image_${look.id}" accept="image/*" style="flex: 1; min-width: 150px;">
                                <button class="btn btn-primary" onclick="updateLookImage('${categoryId}', '${look.id}')">Update Image</button>
                                <button class="btn btn-secondary" onclick="editLookName('${categoryId}', '${look.id}')">Edit Name</button>
                                <button class="btn btn-info" onclick="duplicateLook('${categoryId}', '${look.id}')">Duplicate</button>
                                <button class="btn btn-danger" onclick="deleteLook('${categoryId}', '${look.id}')">Delete</button>
                            </div>
                            <div style="display: flex; gap: 10px; flex-wrap: wrap;">
                                <input type="url" id="imageUrl_${look.id}" placeholder="Or enter image URL" style="flex: 1; min-width: 200px; padding: 8px; border: 1px solid #ddd; border-radius: 4px;">
                                <button class="btn btn-success" onclick="updateLookImageUrl('${categoryId}', '${look.id}')">Update from URL</button>
                            </div>
                        </div>
                    </div>
                `;
                
                looksList.appendChild(lookDiv);
            });
        }

        function addNewLook(categoryId) {
            const name = document.getElementById('newLookName').value;
            const imageFile = document.getElementById('newLookImage').files[0];
            const imageUrl = document.getElementById('newLookImageUrl').value;
            
            if (!name) {
                showNotification('Please enter a look name', 'error');
                return;
            }

            if (!imageFile && !imageUrl) {
                showNotification('Please provide either an image file or image URL', 'error');
                return;
            }

            const formData = new FormData();
            formData.append('name', name);
            if (imageFile) {
                formData.append('image', imageFile);
            }
            if (imageUrl) {
                formData.append('imageUrl', imageUrl);
            }

            fetch(`/api/customization/mood-look/categories/${categoryId}/looks`, {
                method: 'POST',
                body: formData
            })
            .then(response => response.json())
            .then(data => {
                if (data.success) {
                    showNotification('Look added successfully!', 'success');
                    document.getElementById('newLookName').value = '';
                    document.getElementById('newLookImage').value = '';
                    document.getElementById('newLookImageUrl').value = '';
                    loadLooksForCategory(categoryId);
                    loadMoodLookData(); // Refresh main view
                } else {
                    showNotification('Error adding look: ' + data.message, 'error');
                }
            })
            .catch(error => {
                console.error('Error adding look:', error);
                showNotification('Error adding look', 'error');
            });
        }

        function updateLookImage(categoryId, lookId) {
            const imageFile = document.getElementById(`image_${lookId}`).files[0];
            
            if (!imageFile) {
                showNotification('Please select an image', 'error');
                return;
            }

            const formData = new FormData();
            formData.append('image', imageFile);

            fetch(`/api/customization/mood-look/categories/${categoryId}/looks/${lookId}/upload`, {
                method: 'POST',
                body: formData
            })
            .then(response => response.json())
            .then(data => {
                if (data.success) {
                    showNotification('Image updated successfully!', 'success');
                    document.getElementById(`image_${lookId}`).value = '';
                    loadLooksForCategory(categoryId);
                    loadMoodLookData(); // Refresh main view
                } else {
                    showNotification('Error updating image: ' + data.message, 'error');
                }
            })
            .catch(error => {
                console.error('Error updating image:', error);
                showNotification('Error updating image', 'error');
            });
        }

        function updateLookImageUrl(categoryId, lookId) {
            const imageUrl = document.getElementById(`imageUrl_${lookId}`).value;
            
            if (!imageUrl) {
                showNotification('Please enter an image URL', 'error');
                return;
            }

            // Validate URL format
            try {
                new URL(imageUrl);
            } catch (e) {
                showNotification('Please enter a valid URL', 'error');
                return;
            }

            fetch(`/api/customization/mood-look/categories/${categoryId}/looks/${lookId}/update-url`, {
                method: 'PUT',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify({ imageUrl: imageUrl })
            })
            .then(response => response.json())
            .then(data => {
                if (data.success) {
                    showNotification('Image URL updated successfully!', 'success');
                    document.getElementById(`imageUrl_${lookId}`).value = '';
                    loadLooksForCategory(categoryId);
                    loadMoodLookData(); // Refresh main view
                } else {
                    showNotification('Error updating image URL: ' + data.message, 'error');
                }
            })
            .catch(error => {
                console.error('Error updating image URL:', error);
                showNotification('Error updating image URL', 'error');
            });
        }

        function editLookName(categoryId, lookId) {
            const newName = prompt('Enter new look name:');
            if (!newName) return;

            fetch(`/api/customization/mood-look/categories/${categoryId}/looks/${lookId}`, {
                method: 'PUT',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify({ name: newName })
            })
            .then(response => response.json())
            .then(data => {
                if (data.success) {
                    showNotification('Look name updated successfully!', 'success');
                    loadLooksForCategory(categoryId);
                    loadMoodLookData(); // Refresh main view
                } else {
                    showNotification('Error updating look name: ' + data.message, 'error');
                }
            })
            .catch(error => {
                console.error('Error updating look name:', error);
                showNotification('Error updating look name', 'error');
            });
        }

        function duplicateLook(categoryId, lookId) {
            const newName = prompt('Enter name for the duplicated look:');
            if (!newName) return;

            fetch(`/api/customization/mood-look/categories/${categoryId}/looks/${lookId}/duplicate`, {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify({ name: newName })
            })
            .then(response => response.json())
            .then(data => {
                if (data.success) {
                    showNotification('Look duplicated successfully!', 'success');
                    loadLooksForCategory(categoryId);
                    loadMoodLookData(); // Refresh main view
                } else {
                    showNotification('Error duplicating look: ' + data.message, 'error');
                }
            })
            .catch(error => {
                console.error('Error duplicating look:', error);
                showNotification('Error duplicating look', 'error');
            });
        }

        function deleteLook(categoryId, lookId) {
            if (!confirm('Are you sure you want to delete this look?')) return;

            fetch(`/api/customization/mood-look/categories/${categoryId}/looks/${lookId}`, {
                method: 'DELETE'
            })
            .then(response => response.json())
            .then(data => {
                if (data.success) {
                    showNotification('Look deleted successfully!', 'success');
                    loadLooksForCategory(categoryId);
                    loadMoodLookData(); // Refresh main view
                } else {
                    showNotification('Error deleting look: ' + data.message, 'error');
                }
            })
            .catch(error => {
                console.error('Error deleting look:', error);
                showNotification('Error deleting look', 'error');
            });
        }

        function bulkUpdateImages(categoryId) {
            const imageFiles = [];
            const lookIds = [];
            
            // Collect all selected images
            const fileInputs = document.querySelectorAll(`input[id^="image_"]`);
            fileInputs.forEach(input => {
                if (input.files[0]) {
                    const lookId = input.id.replace('image_', '');
                    imageFiles.push(input.files[0]);
                    lookIds.push(lookId);
                }
            });

            if (imageFiles.length === 0) {
                showNotification('Please select at least one image to update', 'error');
                return;
            }

            // Update images one by one
            let completed = 0;
            imageFiles.forEach((file, index) => {
                const formData = new FormData();
                formData.append('image', file);

                fetch(`/api/customization/mood-look/categories/${categoryId}/looks/${lookIds[index]}/upload`, {
                    method: 'POST',
                    body: formData
                })
                .then(response => response.json())
                .then(data => {
                    completed++;
                    if (completed === imageFiles.length) {
                        showNotification(`${completed} images updated successfully!`, 'success');
                        loadLooksForCategory(categoryId);
                        loadMoodLookData(); // Refresh main view
                    }
                })
                .catch(error => {
                    console.error('Error updating image:', error);
                    completed++;
                    if (completed === imageFiles.length) {
                        showNotification('Some images failed to update', 'error');
                        loadLooksForCategory(categoryId);
                        loadMoodLookData(); // Refresh main view
                    }
                });
            });
        }

        // Most Loved management functions
        function loadMostLovedData() {
            console.log('üîÑ Loading most loved data...');
            fetch('/api/customization/most-loved')
                .then(response => response.json())
                .then(data => {
                    if (data.success && data.data) {
                        console.log('üì¶ Loaded most loved data:', data.data);
                        populateMostLovedForm(data.data);
                    }
                })
                .catch(error => {
                    console.error('Error loading most loved data:', error);
                    showNotification('Error loading most loved data', 'error');
                });
        }

        function populateMostLovedForm(mostLovedData) {
            // Populate settings form
            document.getElementById('mostLovedTitle').value = mostLovedData.title?.text || 'Most Loved';
            document.getElementById('mostLovedTitleFontSize').value = mostLovedData.title?.fontSize || '1.8rem';
            document.getElementById('mostLovedTitleFontColor').value = mostLovedData.title?.fontColor || '#2d3748';
            document.getElementById('mostLovedTitleFontFamily').value = mostLovedData.title?.fontFamily || '-apple-system, BlinkMacSystemFont, \'Segoe UI\', Roboto, sans-serif';
            
            document.getElementById('mostLovedSubtitle').value = mostLovedData.subtitle?.text || 'Customers favourite listed every 15 days';
            document.getElementById('mostLovedSubtitleFontSize').value = mostLovedData.subtitle?.fontSize || '1rem';
            document.getElementById('mostLovedSubtitleFontColor').value = mostLovedData.subtitle?.fontColor || '#718096';
            document.getElementById('mostLovedSubtitleFontFamily').value = mostLovedData.subtitle?.fontFamily || '-apple-system, BlinkMacSystemFont, \'Segoe UI\', Roboto, sans-serif';
            
            document.getElementById('mostLovedShowDots').checked = mostLovedData.showCarouselDots !== false;
            document.getElementById('mostLovedAutoplay').checked = mostLovedData.autoplay !== false;
            document.getElementById('mostLovedAutoplayInterval').value = mostLovedData.autoplayInterval || 3000;
            document.getElementById('mostLovedEnabled').checked = mostLovedData.enabled !== false;

            // Render products list
            renderMostLovedProducts(mostLovedData.products || []);
        }

        function renderMostLovedProducts(products) {
            const container = document.getElementById('mostLovedProductsList');
            if (!container) return;

            container.innerHTML = '';
            
            products.forEach(product => {
                const productDiv = document.createElement('div');
                productDiv.className = 'customization-item';
                productDiv.style.cssText = 'border: 1px solid #e9ecef; padding: 15px; margin-bottom: 10px; border-radius: 8px; background: #f8f9fa;';
                
                productDiv.innerHTML = `
                    <div style="display: flex; align-items: center; gap: 15px;">
                        <img src="${product.imageUrl || 'https://via.placeholder.com/100x120?text=No+Image'}" 
                             alt="${product.name}" 
                             style="width: 100px; height: 120px; object-fit: cover; border-radius: 8px;">
                        <div style="flex: 1;">
                            <h4 style="margin: 0 0 10px 0;">${product.name}</h4>
                            <p style="margin: 0 0 10px 0; color: #666;">${product.description}</p>
                            <div style="display: flex; gap: 10px; flex-wrap: wrap;">
                                <input type="file" id="productImage_${product.id}" accept="image/*" style="flex: 1; min-width: 150px;">
                                <button class="btn btn-primary" onclick="updateMostLovedProductImage('${product.id}')">Update Image</button>
                                <button class="btn btn-secondary" onclick="editMostLovedProduct('${product.id}')">Edit Product</button>
                                <button class="btn btn-danger" onclick="deleteMostLovedProduct('${product.id}')">Delete</button>
                            </div>
                            <div style="display: flex; gap: 10px; flex-wrap: wrap; margin-top: 10px;">
                                <input type="url" id="productImageUrl_${product.id}" placeholder="Or enter image URL" style="flex: 1; min-width: 200px; padding: 8px; border: 1px solid #ddd; border-radius: 4px;">
                                <button class="btn btn-success" onclick="updateMostLovedProductImageUrl('${product.id}')">Update from URL</button>
                            </div>
                        </div>
                    </div>
                `;
                
                container.appendChild(productDiv);
            });
        }

        function updateMostLovedSettings() {
            const title = {
                text: document.getElementById('mostLovedTitle').value,
                fontSize: document.getElementById('mostLovedTitleFontSize').value,
                fontColor: document.getElementById('mostLovedTitleFontColor').value,
                fontFamily: document.getElementById('mostLovedTitleFontFamily').value
            };
            
            const subtitle = {
                text: document.getElementById('mostLovedSubtitle').value,
                fontSize: document.getElementById('mostLovedSubtitleFontSize').value,
                fontColor: document.getElementById('mostLovedSubtitleFontColor').value,
                fontFamily: document.getElementById('mostLovedSubtitleFontFamily').value
            };
            
            const enabled = document.getElementById('mostLovedEnabled').checked;
            const showCarouselDots = document.getElementById('mostLovedShowDots').checked;
            const autoplay = document.getElementById('mostLovedAutoplay').checked;
            const autoplayInterval = parseInt(document.getElementById('mostLovedAutoplayInterval').value) || 3000;

            fetch('/api/customization/most-loved', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify({ title, subtitle, enabled, showCarouselDots, autoplay, autoplayInterval })
            })
            .then(response => response.json())
            .then(data => {
                if (data.success) {
                    showNotification('Most loved settings updated successfully!', 'success');
                } else {
                    showNotification('Error updating settings: ' + data.message, 'error');
                }
            })
            .catch(error => {
                console.error('Error updating settings:', error);
                showNotification('Error updating settings', 'error');
            });
        }

        function addMostLovedProduct() {
            const name = prompt('Enter product name:');
            if (!name) return;

            const description = prompt('Enter product description:');
            if (!description) return;

            const imageUrl = prompt('Enter image URL (optional):');

            fetch('/api/customization/most-loved/products', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify({ name, description, imageUrl })
            })
            .then(response => response.json())
            .then(data => {
                if (data.success) {
                    showNotification('Product added successfully!', 'success');
                    loadMostLovedData();
                } else {
                    showNotification('Error adding product: ' + data.message, 'error');
                }
            })
            .catch(error => {
                console.error('Error adding product:', error);
                showNotification('Error adding product', 'error');
            });
        }

        function editMostLovedProduct(productId) {
            const newName = prompt('Enter new product name:');
            if (!newName) return;

            const newDescription = prompt('Enter new product description:');
            if (!newDescription) return;

            fetch(`/api/customization/most-loved/products/${productId}`, {
                method: 'PUT',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify({ name: newName, description: newDescription })
            })
            .then(response => response.json())
            .then(data => {
                if (data.success) {
                    showNotification('Product updated successfully!', 'success');
                    loadMostLovedData();
                } else {
                    showNotification('Error updating product: ' + data.message, 'error');
                }
            })
            .catch(error => {
                console.error('Error updating product:', error);
                showNotification('Error updating product', 'error');
            });
        }

        function deleteMostLovedProduct(productId) {
            if (!confirm('Are you sure you want to delete this product?')) return;

            fetch(`/api/customization/most-loved/products/${productId}`, {
                method: 'DELETE'
            })
            .then(response => response.json())
            .then(data => {
                if (data.success) {
                    showNotification('Product deleted successfully!', 'success');
                    loadMostLovedData();
                } else {
                    showNotification('Error deleting product: ' + data.message, 'error');
                }
            })
            .catch(error => {
                console.error('Error deleting product:', error);
                showNotification('Error deleting product', 'error');
            });
        }

        function updateMostLovedProductImage(productId) {
            const imageFile = document.getElementById(`productImage_${productId}`).files[0];
            
            if (!imageFile) {
                showNotification('Please select an image', 'error');
                return;
            }

            const formData = new FormData();
            formData.append('image', imageFile);

            fetch(`/api/customization/most-loved/products/${productId}/upload`, {
                method: 'POST',
                body: formData
            })
            .then(response => response.json())
            .then(data => {
                if (data.success) {
                    showNotification('Product image updated successfully!', 'success');
                    document.getElementById(`productImage_${productId}`).value = '';
                    loadMostLovedData();
                } else {
                    showNotification('Error updating image: ' + data.message, 'error');
                }
            })
            .catch(error => {
                console.error('Error updating image:', error);
                showNotification('Error updating image', 'error');
            });
        }

        function updateMostLovedProductImageUrl(productId) {
            const imageUrl = document.getElementById(`productImageUrl_${productId}`).value;
            
            if (!imageUrl) {
                showNotification('Please enter an image URL', 'error');
                return;
            }

            // Validate URL format
            try {
                new URL(imageUrl);
            } catch (e) {
                showNotification('Please enter a valid URL', 'error');
                return;
            }

            fetch(`/api/customization/most-loved/products/${productId}/update-url`, {
                method: 'PUT',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify({ imageUrl: imageUrl })
            })
            .then(response => response.json())
            .then(data => {
                if (data.success) {
                    showNotification('Product image URL updated successfully!', 'success');
                    document.getElementById(`productImageUrl_${productId}`).value = '';
                    loadMostLovedData();
                } else {
                    showNotification('Error updating image URL: ' + data.message, 'error');
                }
            })
            .catch(error => {
                console.error('Error updating image URL:', error);
                showNotification('Error updating image URL', 'error');
            });
        }
    </script>
</body>
</html>
